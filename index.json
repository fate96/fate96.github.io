[{"categories":["算法"],"content":"Manacher 算法","date":"2022-03-21","objectID":"/posts/manacher-%E7%AE%97%E6%B3%95.html/","tags":["算法","Manacher","剑指 Offer"],"title":"Manacher 算法","uri":"/posts/manacher-%E7%AE%97%E6%B3%95.html/"},{"categories":["算法"],"content":"前言 检查字符串是否为回文序列，常用方法有 中心扩展 和 Manacher 。前者的时间复杂度为 O(n^2) ，后者算法的时间复杂度为 O(n) ，可以在线性时间的完成回文序列的判断 剑指 Offer II 020. 回文子字符串的个数 ","date":"2022-03-21","objectID":"/posts/manacher-%E7%AE%97%E6%B3%95.html/:1:0","tags":["算法","Manacher","剑指 Offer"],"title":"Manacher 算法","uri":"/posts/manacher-%E7%AE%97%E6%B3%95.html/"},{"categories":["算法"],"content":"算法思想 Manacher 算法是利用保存前字符串序列的最大回文半径来减少后续字符串回文与否的判定。算法过程如下： 先将初始字符串在每个字符间增加一个间隔符号，比如 # （也包括在字符串的开头和字符串的结尾），该步骤主要是为了将偶数回文序列和奇数回文序列合并在一起进行判断。同时在字符串的开头分别加上两个不同的特殊符号，比如开头增加 $ ，结尾增加 ^ ，这两个字符充当哨兵作用 \"abab\" ---\u003e \"$#a#b#a#b$^\" 创建上述字符串的半径数组，从左往右依次计算各序号的半径，同时记录当前的字符串回文的最大右边界 rmax 和对于的序号 maxi，计算过程如下： 当该序号 i 小于等于保存的最大的右边界 rmax 时，则将当前序号的半径初始化为 r = max(rmax - i + 1, 2 * maxi - i) 反之，则直接初始化为 1 再使用 中心扩展法 判断当前半径是否为最大回文序列半径，若不是，则递增继续判断（在上一步骤中，若得到的r + i 小于最大右边界时，则 r即为当前序号的最大半径；若等于最大右边界时，则需要该步骤进行判断） 从上述步骤看，主要思路是通过记录当前序号的最大半径 r 和最大右边界 rmax，减少后续序号最大半径的搜索范围。（中心扩展法 默认都是从半径为 1 依次进行判断）。该算法思路与字符串KMP算法思想类似 ","date":"2022-03-21","objectID":"/posts/manacher-%E7%AE%97%E6%B3%95.html/:2:0","tags":["算法","Manacher","剑指 Offer"],"title":"Manacher 算法","uri":"/posts/manacher-%E7%AE%97%E6%B3%95.html/"},{"categories":["算法"],"content":"代码 class Solution { public int countSubstrings(String s) { int res = 0; StringBuilder sb = new StringBuilder(); sb.append(\"$#\"); for(int i = 0; i \u003c s.length(); i++){ sb.append(s.charAt(i)); sb.append(\"#\"); } sb.append('^'); int[] r = new int[sb.length()]; r[0] = 1; int max = r[0]; int maxi = 0; for(int i = 1; i \u003c r.length - 1; i++){ r[i] = i \u003c max ? Math.min(max - i + 1, r[2 * maxi - i]) : 1; while(sb.charAt(i - r[i]) == sb.charAt(i + r[i])){ r[i]++; } if(i + r[i] - 1 \u003e= max){ max = i + r[i] - 1; maxi = i; } res += r[i] / 2; } return res; } } ","date":"2022-03-21","objectID":"/posts/manacher-%E7%AE%97%E6%B3%95.html/:3:0","tags":["算法","Manacher","剑指 Offer"],"title":"Manacher 算法","uri":"/posts/manacher-%E7%AE%97%E6%B3%95.html/"},{"categories":["算法"],"content":"参考链接 Manacher 算法 回文子字符串的个数 ","date":"2022-03-21","objectID":"/posts/manacher-%E7%AE%97%E6%B3%95.html/:4:0","tags":["算法","Manacher","剑指 Offer"],"title":"Manacher 算法","uri":"/posts/manacher-%E7%AE%97%E6%B3%95.html/"},{"categories":["leetcode"],"content":"前缀和的原理和基本应用场景","date":"2022-03-18","objectID":"/posts/%E8%93%84%E6%B0%B4%E6%B1%A0%E6%8A%BD%E6%A0%B7%E6%B3%95.html/","tags":["算法","蓄水池抽样"],"title":"蓄水池抽样法","uri":"/posts/%E8%93%84%E6%B0%B4%E6%B1%A0%E6%8A%BD%E6%A0%B7%E6%B3%95.html/"},{"categories":["leetcode"],"content":"前言 382. 链表随机节点 给你一个单链表，随机选择链表的一个节点，并返回相应的节点值。每个节点 被选中的概率一样 。 实现 Solution 类： Solution(ListNode head) 使用整数数组初始化对象。 int getRandom() 从链表中随机选择一个节点并返回该节点的值。链表中所有节点被选中的概率相等。 ","date":"2022-03-18","objectID":"/posts/%E8%93%84%E6%B0%B4%E6%B1%A0%E6%8A%BD%E6%A0%B7%E6%B3%95.html/:1:0","tags":["算法","蓄水池抽样"],"title":"蓄水池抽样法","uri":"/posts/%E8%93%84%E6%B0%B4%E6%B1%A0%E6%8A%BD%E6%A0%B7%E6%B3%95.html/"},{"categories":["leetcode"],"content":"算法思想 以下内容摘自蓄水池抽样算法（Reservoir Sampling） 给定一个数据流，数据流长度N很大，且N直到处理完所有数据之前都不可知，请问如何在只遍历一遍数据（O(N)）的情况下，能够随机选取出m个不重复的数据。 ","date":"2022-03-18","objectID":"/posts/%E8%93%84%E6%B0%B4%E6%B1%A0%E6%8A%BD%E6%A0%B7%E6%B3%95.html/:2:0","tags":["算法","蓄水池抽样"],"title":"蓄水池抽样法","uri":"/posts/%E8%93%84%E6%B0%B4%E6%B1%A0%E6%8A%BD%E6%A0%B7%E6%B3%95.html/"},{"categories":["leetcode"],"content":"原理 第i个接收到的数据最后能够留在蓄水池中的概率=*第i个数据进入过蓄水池的概率***之后第i个数据不被替换的概率（第i+1到第N次处理数据都不会被替换）。 当i\u003c=m时，数据直接放进蓄水池，所以第i个数据进入过蓄水池的概率=1。 当i\u003em时，在[1,i]内选取随机数d，如果d\u003c=m，则使用第i个数据替换蓄水池中第d个数据，因此第i个数据进入过蓄水池的概率=m/i。 当i\u003c=m时，程序从接收到第m+1个数据时开始执行替换操作，第m+1次处理会替换池中数据的为m/(m+1)，会替换掉第i个数据的概率为1/m，则第m+1次处理替换掉第i个数据的概率为(m/(m+1))(1/m)=1/(m+1)，不被替换的概率为1-1/(m+1)=m/(m+1)。依次，第m+2次处理不替换掉第i个数据概率为(m+1)/(m+2)…第N次处理不替换掉第i个数据的概率为(N-1)/N。所以，之后**第i个数据不被替换的概率=m/(m+1)(m+1)/(m+2)…(N-1)/N=m/N**。 当i\u003em时，程序从接收到第i+1个数据时开始有可能替换第i个数据。则参考上述第3点，之后第i个数据不被替换的概率=i/N。 结合第1点和第3点可知，当i\u003c=m时，第i个接收到的数据最后留在蓄水池中的概率=1m/N=m/N。结合第2点和第4点可知，当i\u003em时，第i个接收到的数据留在蓄水池中的概率=m/ii/N=m/N。综上可知，每个数据最后被选中留在蓄水池中的概率为m/N。 ","date":"2022-03-18","objectID":"/posts/%E8%93%84%E6%B0%B4%E6%B1%A0%E6%8A%BD%E6%A0%B7%E6%B3%95.html/:2:1","tags":["算法","蓄水池抽样"],"title":"蓄水池抽样法","uri":"/posts/%E8%93%84%E6%B0%B4%E6%B1%A0%E6%8A%BD%E6%A0%B7%E6%B3%95.html/"},{"categories":["leetcode"],"content":"拓展 假设有K台机器，将大数据集分成K个数据流，每台机器使用单机版蓄水池抽样处理一个数据流，抽样m个数据，并最后记录处理的数据量为N1, N2, …, Nk, …, NK(假设m\u003cNk)。N1+N2+…+NK=N。 取[1, N]一个随机数d，若d\u003cN1，则在第一台机器的蓄水池中等概率不放回地（1/m）选取一个数据；若N1\u003c=d\u003c(N1+N2)，则在第二台机器的蓄水池中等概率不放回地选取一个数据；一次类推，重复m次，则最终从N大数据集中选出m个数据。 验证如下： 第k台机器中的蓄水池数据被选取的概率为m/Nk。 从第k台机器的蓄水池中选取一个数据放进最终蓄水池的概率为Nk/N。 第k台机器蓄水池的一个数据被选中的概率为1/m。（不放回选取时等概率的） 重复m次选取，则每个数据被选中的概率为m*(m/Nk*Nk/N*1/m)=m/N ","date":"2022-03-18","objectID":"/posts/%E8%93%84%E6%B0%B4%E6%B1%A0%E6%8A%BD%E6%A0%B7%E6%B3%95.html/:3:0","tags":["算法","蓄水池抽样"],"title":"蓄水池抽样法","uri":"/posts/%E8%93%84%E6%B0%B4%E6%B1%A0%E6%8A%BD%E6%A0%B7%E6%B3%95.html/"},{"categories":["leetcode"],"content":"代码 class Solution { ListNode head; Random random; public Solution(ListNode head) { this.head = head; random = new Random(); } public int getRandom() { int i = 1, ans = 0; for (ListNode node = head; node != null; node = node.next) { if (random.nextInt(i) == 0) { // 1/i 的概率选中（替换为答案） ans = node.val; } ++i; } return ans; } } ","date":"2022-03-18","objectID":"/posts/%E8%93%84%E6%B0%B4%E6%B1%A0%E6%8A%BD%E6%A0%B7%E6%B3%95.html/:4:0","tags":["算法","蓄水池抽样"],"title":"蓄水池抽样法","uri":"/posts/%E8%93%84%E6%B0%B4%E6%B1%A0%E6%8A%BD%E6%A0%B7%E6%B3%95.html/"},{"categories":["leetcode"],"content":"参考链接 蓄水池抽样算法（Reservoir Sampling） 382. 链表随机节点 ","date":"2022-03-18","objectID":"/posts/%E8%93%84%E6%B0%B4%E6%B1%A0%E6%8A%BD%E6%A0%B7%E6%B3%95.html/:5:0","tags":["算法","蓄水池抽样"],"title":"蓄水池抽样法","uri":"/posts/%E8%93%84%E6%B0%B4%E6%B1%A0%E6%8A%BD%E6%A0%B7%E6%B3%95.html/"},{"categories":["leetcode"],"content":"前缀和的原理和基本应用场景","date":"2022-03-18","objectID":"/posts/%E5%89%8D%E7%BC%80%E5%92%8C.html/","tags":["算法","前缀和","剑指 Offer"],"title":"前缀和","uri":"/posts/%E5%89%8D%E7%BC%80%E5%92%8C.html/"},{"categories":["leetcode"],"content":"前言 在算法中，如果需要求一些连续数组成的集合，可以使用前缀和对结果进行存储，从而避免暴力搜索，利用空间复杂度换取时间复杂度 例如leetcode中的 剑指 Offer II 008. 和大于等于 target 的最短子数组 ","date":"2022-03-18","objectID":"/posts/%E5%89%8D%E7%BC%80%E5%92%8C.html/:1:0","tags":["算法","前缀和","剑指 Offer"],"title":"前缀和","uri":"/posts/%E5%89%8D%E7%BC%80%E5%92%8C.html/"},{"categories":["leetcode"],"content":"算法思想 创建一个前缀数组 pre[n] ，其中 pre[i] 表示前 i 个数组所构成的数据结果，例如对于 剑指 Offer II 008. 和大于等于 target 的最短子数组 题目，则可以表示为前 i 个元素和。因为是求连续数组，则可以通过 pre[j] - pre[i] 表示任意第 i 个元素到第 j 个元素的的连续数组，即使用前缀和来减少暴力搜索的时间复杂度，这样算法的时间复杂度为O(N^2)，空间复杂度为 O(N) ","date":"2022-03-18","objectID":"/posts/%E5%89%8D%E7%BC%80%E5%92%8C.html/:2:0","tags":["算法","前缀和","剑指 Offer"],"title":"前缀和","uri":"/posts/%E5%89%8D%E7%BC%80%E5%92%8C.html/"},{"categories":["leetcode"],"content":"再优化 尽管使用了前缀和思想，可以将时间复杂度降至O(N^2)，但在 n足够大时，仍然会出现超时情况。为此，可以根据题目的不同要求，在求前缀和的过程中，使用其他数据结构将所需要的数据进行保存，比如使用 HashMap 。这在后续求解时，可以使用 O(1) 的时间复杂度进行求解，例如在 剑指 Offer II 011. 0 和 1 个数相同的子数组 题目当中，使用 Key 将结果作为索引 ，位置信息作为 Value 进行保存 ","date":"2022-03-18","objectID":"/posts/%E5%89%8D%E7%BC%80%E5%92%8C.html/:3:0","tags":["算法","前缀和","剑指 Offer"],"title":"前缀和","uri":"/posts/%E5%89%8D%E7%BC%80%E5%92%8C.html/"},{"categories":["leetcode"],"content":"代码 剑指 Offer II 008. 和大于等于 target 的最短子数组 示例参考代码如下 class Solution { public int minSubArrayLen(int s, int[] nums) { int n = nums.length; if (n == 0) { return 0; } int ans = Integer.MAX_VALUE; int[] sums = new int[n + 1]; // 为了方便计算，令 size = n + 1 // sums[0] = 0 意味着前 0 个元素的前缀和为 0 // sums[1] = A[0] 前 1 个元素的前缀和为 A[0] // 以此类推 for (int i = 1; i \u003c= n; i++) { sums[i] = sums[i - 1] + nums[i - 1]; } for (int i = 1; i \u003c= n; i++) { int target = s + sums[i - 1]; int bound = Arrays.binarySearch(sums, target); if (bound \u003c 0) { bound = -bound - 1; } if (bound \u003c= n) { ans = Math.min(ans, bound - (i - 1)); } } return ans == Integer.MAX_VALUE ? 0 : ans; } } ","date":"2022-03-18","objectID":"/posts/%E5%89%8D%E7%BC%80%E5%92%8C.html/:4:0","tags":["算法","前缀和","剑指 Offer"],"title":"前缀和","uri":"/posts/%E5%89%8D%E7%BC%80%E5%92%8C.html/"},{"categories":["leetcode"],"content":"参考链接 剑指 Offer II 008. 和大于等于 target 的最短子数组 ","date":"2022-03-18","objectID":"/posts/%E5%89%8D%E7%BC%80%E5%92%8C.html/:5:0","tags":["算法","前缀和","剑指 Offer"],"title":"前缀和","uri":"/posts/%E5%89%8D%E7%BC%80%E5%92%8C.html/"},{"categories":["archlinux"],"content":"aria2 的基本安装和使用","date":"2022-03-08","objectID":"/posts/aria2%E9%85%8D%E7%BD%AE.html/","tags":["aria2"],"title":"Aria2的基本配置","uri":"/posts/aria2%E9%85%8D%E7%BD%AE.html/"},{"categories":["archlinux"],"content":"前言 最近节点也不知道怎么了，从谷歌云盘下载东西时，经常因为断流而导致下载中断，导致我的大文件几乎就下不下来，网上找了下解决方法，最后选择aria2，一个支持断点续传的软件 aria2 是一个轻量级的多协议和多源命令行下载实用程序。它支持 HTTP/HTTPS、FTP、BitTorrent 和 Metalink。 aria2 可以通过内置的 JSON-RPC 和 XML-RPC 接口进行操作。 ","date":"2022-03-08","objectID":"/posts/aria2%E9%85%8D%E7%BD%AE.html/:1:0","tags":["aria2"],"title":"Aria2的基本配置","uri":"/posts/aria2%E9%85%8D%E7%BD%AE.html/"},{"categories":["archlinux"],"content":"安装 aria2 可以在Arch的官方仓库找到 sudo pacman -S aria2 同时 archlinuxcn 源和 AUR 仓库都存在对原版 aria2 补丁的 aria2-fast，原版设置了16线程的上线，该补丁版本最多可以设置为128线程 yay -S aria2-fast ","date":"2022-03-08","objectID":"/posts/aria2%E9%85%8D%E7%BD%AE.html/:2:0","tags":["aria2"],"title":"Aria2的基本配置","uri":"/posts/aria2%E9%85%8D%E7%BD%AE.html/"},{"categories":["archlinux"],"content":"配置 aria2 默认配置文件位于 $HOME/.aria2/aria2.conf ，具体配置内容可以参考arch wiki 或者 P3TERX 大佬的 注意：若开启了 session,需要手动创建对应的 aria2.session 文件，否则 daemon 启动不了 ","date":"2022-03-08","objectID":"/posts/aria2%E9%85%8D%E7%BD%AE.html/:3:0","tags":["aria2"],"title":"Aria2的基本配置","uri":"/posts/aria2%E9%85%8D%E7%BD%AE.html/"},{"categories":["archlinux"],"content":"设置daemon 一般情况下，aria2 下载完成后便会退出，因此我们可以使用守护单元，在开机后自动在后台保持允许即可 用户级别的 systemd unit 位于 $HOME/.config/systemd/usr 目录下，系统级别的在 /etc/systemd/system 目录下，根据自己情况选择。本教程采用用户级别 编辑对应目下的aria2.service，配置内容如下 [Unit] Description=aria2 Daemon [Service] Type=simple ExecStart=/usr/bin/aria2c --conf-path=${HOME}/.config/aria2/aria2.conf [Install] WantedBy=default.target 接着设置后台自启并立即启动 systemctl enable --user now aria2.service ","date":"2022-03-08","objectID":"/posts/aria2%E9%85%8D%E7%BD%AE.html/:4:0","tags":["aria2"],"title":"Aria2的基本配置","uri":"/posts/aria2%E9%85%8D%E7%BD%AE.html/"},{"categories":["archlinux"],"content":"浏览器配置 AriaNG 是较为主流的 aria2 前端，其中有第三方在此基础之上实现的浏览器插件，比如 Chrome和 Firefox 根据配置文件的设置的RPC服务器的密码，在插件中配置好相应的 rpc-secret，同时可以在扩展选项中设置对浏览器的下载进行拦截，统一交给 aria2 服务进行下载 插件设置内容如下图所示 }} -- 至此，完成了 aria2 的基本设置 ","date":"2022-03-08","objectID":"/posts/aria2%E9%85%8D%E7%BD%AE.html/:5:0","tags":["aria2"],"title":"Aria2的基本配置","uri":"/posts/aria2%E9%85%8D%E7%BD%AE.html/"},{"categories":["archlinux"],"content":"参考资料 Archlinux aria2 Aria2 前端面板 ( GUI、WebUI ) AriaNg 使用教程 Arch Linux 的 Aria2 食用指南 ","date":"2022-03-08","objectID":"/posts/aria2%E9%85%8D%E7%BD%AE.html/:6:0","tags":["aria2"],"title":"Aria2的基本配置","uri":"/posts/aria2%E9%85%8D%E7%BD%AE.html/"},{"categories":["archlinux"],"content":"Archlinux 开机磁盘自动解密","date":"2022-03-08","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/","tags":["archlinux","LUKS"],"title":"Archlinux自动解密磁盘","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"前言 由于我的Archlinux使用了LUKS进行磁盘加密，所以在启动系统时，必须输入两次密码，一次是加密磁盘的密码，另一次是用户密码 为了减少每次进入输入系统输入两次密码的麻烦，可以设置开机后自动解锁磁盘 ","date":"2022-03-08","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:1:0","tags":["archlinux","LUKS"],"title":"Archlinux自动解密磁盘","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"加密磁盘 加密磁盘操作具体可以参照Archlinux基础系统安装 ","date":"2022-03-08","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:2:0","tags":["archlinux","LUKS"],"title":"Archlinux自动解密磁盘","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"开机磁盘解密 ","date":"2022-03-08","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:3:0","tags":["archlinux","LUKS"],"title":"Archlinux自动解密磁盘","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"配置开机钩子 开机解密，需要配置开机的钩子(Hook)，根据解密钩子的方式可以分为encrypt hook和sd-encrypt hook，其中后者特性更多，因此采用后者进行解密。编辑/etc/mkinitcpio.conf文件 ，将udev更换为systemd，并添加sd-vconsole和sd-encrypt 修改前 HOOKS=(base udev autodetect keyboard modconf block filesystems fsck) 修改后为 HOOKS=(base systemd autodetect keyboard sd-vconsole modconf block sd-encrypt filesystems fsck) 在FILES=()这一栏中添加开机解密密钥的文件所在的位置 FILES=(/path/to/keyfile) 配置完后，重新生成mkinitcpio配置文件 mkinitcpio -P ","date":"2022-03-08","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:3:1","tags":["archlinux","LUKS"],"title":"Archlinux自动解密磁盘","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"配置内核参数 开机解密磁盘需要告诉内核加密磁盘所在的位置，所以需要配置对应的内核参数，编辑/etc/default/grub文件，在GRUB_CMDLINE_LINUX_DEFAULT或者GRUB_CMDLINE_LINUX参数栏中增加需要添加的内核参数，前者在每次开机都会进行加载，而后者在紧急启动进入系统时则不会加载，所以建议添加在前者栏中 rd.luks.uuid=XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX，使用此标志指定要在启动时解密的设备的UUID rd.luks.name=XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX=name，指定加密磁盘的UUID和解密后的磁盘名，使用了该内核参数，则可以省略上面的uuid参数 rd.luks.key=XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX=/path/to/keyfile，使用keyfile进行系统解密，并传入keyfile的文件位置 rd.luks.options=options，设置解密参数，可选设置。如果是SSD，可以使用discard参数提供TRIM功能 root=/dev/mapper/cryptroot: 指定解密设备，该参数不管是encrypt还是sd-crypt，都必须要设置 其中UUID获取指令如下，获取的是解密前的磁盘UUID，而不是解密后的磁盘UUID lsblk -f └─nvme0n1p2 crypto 2 a0ea985c-f2c0-4c6c-af66-2bc10a158b0a └─cryptroot ext4 1.0 96055a51-9138-431a-8976-845ca1d09e20 上述查询结果中，a0ea985c-f2c0-4c6c-af66-2bc10a158b0a才是我们需要的UUID参数 注意：这和休眠设置的UUID参数不同，休眠需要的是解密后的UUID 如下示例: GRUB_CMDLINE_LINUX_DEFAULT=\"rd.luks.name=a0ea985c-f2c0-4c6c-af66-2bc10a158b0a=cryptroot rd.luks.options=timeout=10s,discard rd.luks.key=a0ea985c-f2c0-4c6c-af66-2bc10a158b0a=/etc/mykeyfile root=/dev/mapper/cryptroot\" 修改后，重新生成grub的配置文件 grub-mkconfig -o /boot/grub/grub.cfg 至此，重启开机便可以自动使用密钥进行解锁，而需要手动输入密码进行解锁磁盘了。 ","date":"2022-03-08","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:3:2","tags":["archlinux","LUKS"],"title":"Archlinux自动解密磁盘","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"参考资料 dm-crypt/System configuration 让系统更安全 - 系统分区加密 (Btrfs on LUKS) 操作实录 ","date":"2022-03-08","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:4:0","tags":["archlinux","LUKS"],"title":"Archlinux自动解密磁盘","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["YADM"],"content":"Yadm 对 dotfiles 文件的基本使用方法","date":"2022-03-08","objectID":"/posts/yadm%E4%BD%BF%E7%94%A8.html/","tags":["YADM"],"title":"Yadm的基本使用","uri":"/posts/yadm%E4%BD%BF%E7%94%A8.html/"},{"categories":["YADM"],"content":"前言 在linux系统下，配置文件一般都是以.符号开头的，因此也被称为 dotfles。github有他人分享的配置，我们可以从中找到适合自己的配置文件 为了方便管理自己系统系统的配置文件，可以使用工具来对这些 dotfiles 进行统一管理。根据 arch wiki，常用的管理方式主要分为两种，软链接和git跟踪点文件，以下是 github 仓库中用的较多的工具 stow: GNU产品，使用软链进行管理，arch的farseerfc大佬就是使用该工具进行管理，具体介绍可以参照他的博客使用GNU stow 管理你的点文件 git bare: 使用git bare裸仓库进行管理 yadm: Yet Another Dotfiles Manager，一个git的wrapper，底层仍然是使用git来进行管理，方法使用和git没有区别，可以对特定文件加密 chezmoi: 和git用法差不多，但是会将需要跟踪的点文件冗余存储在chezmoi特定的本地仓库，可以对特定文件加密 为了保持和 git 的使用习惯，最后选择yadm作为点文件的管理工具，yadm默认相对位置为自己的家目录($HOME) ","date":"2022-03-08","objectID":"/posts/yadm%E4%BD%BF%E7%94%A8.html/:1:0","tags":["YADM"],"title":"Yadm的基本使用","uri":"/posts/yadm%E4%BD%BF%E7%94%A8.html/"},{"categories":["YADM"],"content":"安装 Archlinux sudo pacman -S yadm Ubuntu/Debian sudo apt install -y yadm OSX brew install yadm ","date":"2022-03-08","objectID":"/posts/yadm%E4%BD%BF%E7%94%A8.html/:2:0","tags":["YADM"],"title":"Yadm的基本使用","uri":"/posts/yadm%E4%BD%BF%E7%94%A8.html/"},{"categories":["YADM"],"content":"仓库初始化 ","date":"2022-03-08","objectID":"/posts/yadm%E4%BD%BF%E7%94%A8.html/:3:0","tags":["YADM"],"title":"Yadm的基本使用","uri":"/posts/yadm%E4%BD%BF%E7%94%A8.html/"},{"categories":["YADM"],"content":"初始化本地仓库 如果一开始没有远程的 dotfiles 仓库，则需要先初始化本地仓库 yadm init yadm add \u003cimportant file\u003e yadm commit 再将本地仓库与远程仓库进行同步 yadm remote add origin \u003curl\u003e yadm push -u origin main ","date":"2022-03-08","objectID":"/posts/yadm%E4%BD%BF%E7%94%A8.html/:3:1","tags":["YADM"],"title":"Yadm的基本使用","uri":"/posts/yadm%E4%BD%BF%E7%94%A8.html/"},{"categories":["YADM"],"content":"同步远程仓库 若一开始就有远程仓库，或使用他人的 yadm 的远程仓库时，则将远程仓库克隆下来即可 yadm clone \u003curl\u003e yadm status ","date":"2022-03-08","objectID":"/posts/yadm%E4%BD%BF%E7%94%A8.html/:3:2","tags":["YADM"],"title":"Yadm的基本使用","uri":"/posts/yadm%E4%BD%BF%E7%94%A8.html/"},{"categories":["YADM"],"content":"基本使用 ","date":"2022-03-08","objectID":"/posts/yadm%E4%BD%BF%E7%94%A8.html/:4:0","tags":["YADM"],"title":"Yadm的基本使用","uri":"/posts/yadm%E4%BD%BF%E7%94%A8.html/"},{"categories":["YADM"],"content":"添加需要跟踪的配置文件 使用 add 方法，将 dotfile 添加至 yadm 跟踪 list 当中 yadm add /path/to/dotfile ","date":"2022-03-08","objectID":"/posts/yadm%E4%BD%BF%E7%94%A8.html/:4:1","tags":["YADM"],"title":"Yadm的基本使用","uri":"/posts/yadm%E4%BD%BF%E7%94%A8.html/"},{"categories":["YADM"],"content":"跟踪列表查看 使用 list 方法，查看当前路径下的跟踪文件，使用 -a 参数(Optional)，可以查看所有跟踪文件 yadm list \u003c-a\u003e ","date":"2022-03-08","objectID":"/posts/yadm%E4%BD%BF%E7%94%A8.html/:4:2","tags":["YADM"],"title":"Yadm的基本使用","uri":"/posts/yadm%E4%BD%BF%E7%94%A8.html/"},{"categories":["YADM"],"content":"推送至远程仓库 使用commit和push方法，将变化文件推送至远程仓库 git commit -m \"commit word\" git push -u origin main ","date":"2022-03-08","objectID":"/posts/yadm%E4%BD%BF%E7%94%A8.html/:4:3","tags":["YADM"],"title":"Yadm的基本使用","uri":"/posts/yadm%E4%BD%BF%E7%94%A8.html/"},{"categories":["YADM"],"content":"文件加密和解密 在$HOME/.config/yadm/encrypt文件中设置需要加密的文件，支持正则表达式，默认文件的起始地址为%HOME目录下，$HOME/.config/yadm/encrypt参考格式如下 .ssh/*.key yadm支持gpg的对称加密和非对称加密，默认加密方式为gpg的对称加密，加密后的文件存储于 $HOME/.local/share/yadm/archive 文件当中， yadm add $HOME/.config/yadm/encrypt yadm add $HOME/.local/share/yadm/archive 也可以通过 yadm config yadm.gpg-recipient \u003crecipient-address\u003e 指令指定使用非对称加密 yadm config yadm.gpg-recipient \u003crecipient-address\u003e chezmoi 不同的是，yadm 需要将文件手动进行解密，若使用对称加密，则按提示输入密码既可进行解密 注：系统没有 gunpg 则，则无法解密 yadm decrypt ","date":"2022-03-08","objectID":"/posts/yadm%E4%BD%BF%E7%94%A8.html/:5:0","tags":["YADM"],"title":"Yadm的基本使用","uri":"/posts/yadm%E4%BD%BF%E7%94%A8.html/"},{"categories":["YADM"],"content":"引导程序 yadm 支持在初始化仓库时，自动调用 Bootstrap 程序执行初始化，该文件默认位置为$HOME/.config/yadm/bootstrap，且该文件必须为可执行程序 在初始化时，如果系统本身就含有 yadm 仓库对应的点文件时，yadm 默认是不会处理该文件，即不会覆盖，需要用户自己手动处理该冲突，对于引导程序，除了初始化执行时，也可以手动执行引导程序，来进行引导程序的调试 yadm bootstrap ","date":"2022-03-08","objectID":"/posts/yadm%E4%BD%BF%E7%94%A8.html/:6:0","tags":["YADM"],"title":"Yadm的基本使用","uri":"/posts/yadm%E4%BD%BF%E7%94%A8.html/"},{"categories":["YADM"],"content":"参考资料 Archlinux Dotfiles Yet Another Dotfiles Manager 使用Yadm来管理我的配置 使用GNU stow 管理你的点文件 ","date":"2022-03-08","objectID":"/posts/yadm%E4%BD%BF%E7%94%A8.html/:7:0","tags":["YADM"],"title":"Yadm的基本使用","uri":"/posts/yadm%E4%BD%BF%E7%94%A8.html/"},{"categories":["Clash"],"content":"Clash 在 linux 下的的基本安装和使用","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/","tags":["Clash"],"title":"Clash安装与使用","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["Clash"],"content":"前言 Clash 是一个跨平台、支持 SS/V2ray 等协议、基于规则的网络代理软件 Clash 只是一个内核，为开源软件，而 Clash-premium 是闭源软件，后者多了scripts，rule-set和tun(windows只能使用该功能实现全局代理) 从clash的内核衍生了众多版本，用的最多的有 Clash for windows (简称 cfw )，Open Clash，Clashx。其中cfw不仅支持windows，还支持macos和linux，open Clash只支持路由器的openwrt系统，Clashx只支持macos ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:1:0","tags":["Clash"],"title":"Clash安装与使用","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["Clash"],"content":"安装 在 arch 的官方仓库当中有根据 clash 内核打包好的组件，aur社区有打包好的 cfw 和 clash-user。其中cfw有ui界面，与 windows 上设置没有什么区别，而 clash-user 自带 clash 用户，可以根据用户的 uid 来设置防止流量回环 由于 linux 可以使用 tproxy 实现全局代理，可以直接使用官方仓库的 clash (或者 aur 的 clash-user ），来减少 clash 的资源占用( cfw 的 gui 需要占用资源) sudo pacman -S clash 使用yacd面板对Clash管理和流量监控 yay -S yacd ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:2:0","tags":["Clash"],"title":"Clash安装与使用","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["Clash"],"content":"文件配置 clash 默认的配置文件位于用户目录下，而 clash-user 的配置位于/etc/clash目录下 配置中主要参数解释： port: http(s)代理端口 socks-port: socks5代理端口 redir-port: redir tcp代理端口 tproxy-port: tproxy udp(tcp)代理端口 mode: 代理方式，有全局代理(gloable)、规则代理(rule)和直连(direct)。其rle根据配置所提供的规则流量代理 external-controller: clash提供的api控制地址 external-ui: 外部控制ui地址 profile: clash部分存储设置模块 store-selected: 策略组节点选择后，是否需要存储选择记录，默认不存储(false) store-fake-ip: 设置为 true 是，将 fake-ip 与真实 dns 的 ip 对应记录存储在本地，以达到持久存储 dns 记录，加快 dns 解析速度 dns: clash的dns模块 enable: 设置为 true 时开启 clash 内置的dns模块 listen: dns 的监听端口 enhanced-mode: clash 提供两种 dns 查询模式，一种为正常 redir 转发模式，另一种为 fake-ip 模式，每次应用 dns 请求时，clash 将返回一个 fake 的 ip 地址，来达到加速建立 tcp 连接需求，但也会导致得到的 ip 不是真实的 ip，从而对某些网络调试带来麻烦 nameserver: dns 查询服务器，可以设置为 doh，tls 等dns查询方式。具体可以根根据个人习惯设置 fake-ip-filter: 过滤不使用 fake-ip 查来询dns的地址 proxies: 代理节点设置模块，请根据官方要求进行设置 proxy-groups: clash 的策略组，与 surge 类似。包含 relay(轮询)，url-test(ping最低优先)，load-balance(负载均衡)，fallback(按节点顺序优先使用可用节点)，select(手动选择节点) proxy-providers: 节点提供模块，一次可以提供多个级诶但，clash的1.9.0中增加了filter用来过滤节点 type: 节点组提供的类型，可选 http (远程提供)和 file (本地文件提供) filter: 节点过滤方式，支持正则 rules: 规则模块，以下是官方提供的说明，可以根据需要进行规则设置 DOMAIN: 规则会匹配与请求完全相同的地址 DOMAIN-SUFFIX: 规则会匹配与请求与主域名相同的地址，比如，google.com匹配www.google.com, mail.google.com和google.com本身，但不会匹配content-google.com DOMAIN-KEYWORD: 规则会匹配包含相应关键字的域名，除了 “apple” 会匹配 www.apple.com，“app” 同样也会匹配到 GEOIP: 规则会匹配相应国家和地区的 IP 地址 IP-CIDR: 规则会匹配规则范围内请求的 IP 地址 IP-CIDR6: 规则会匹配规则范围内请求的 IPv6 地址 SRC-IP-CIDR: 规则会匹配源 IP 地址 SRC-PORT: 规则会匹配源端口地址 DST-PORT: 规则会匹配目的地端口地址 PROCESS-NAME: 规则会匹配这个进程名的程序 MATCH: 将其余数据包路由到策略。此规则是必需的 以下为本人根据 clash 提供的官方配置进行更改的自用配置。dns 设置为 fake-ip 模式，dns 服务器均采用 doh，防止国内而 dns 污染，并使用 yacd 模块。因为 clash 开源版不支持rule-set模块(clash-premium支持)，所以不能像 surge 一样简洁书写规则，嫌规则冗长的可以使用 clash-premium 闭源软件书写，其他模块书写规则一致 mixed-port:7890allow-lan:truemode:Rulelog-level:warningexternal-controller:127.0.0.1:9090socks-port:7891redir-port:7892tproxy-port:7893ipv6:falseexternal-ui:'/usr/share/yacd'profile:store-selected:falsestore-fake-ip:truedns:enable:truelisten:0.0.0.0:1053enhanced-mode:fake-ipfake-ip-range:198.18.0.1/16nameserver:- https://223.5.5.5/dns-query- https://doh.pub/dns-query#- 114.114.114.114#- 223.5.5.5fallback:- https://1.1.1.1/dns-query- https://1.0.0.1/dns-query- https://8.8.8.8/dns-queryfallback-filter:geoip:truegeoip-code:CNfake-ip-filter:- '*.lan'- '*.localhost'- '*.local'- 'lens.l.google.com'- 'stun.l.google.com'- '*.gitbook.io'proxy-providers:HK_LOW:type:filepath:./cordcloud.yamlinterval:3600filter:'长沙联通转香港|广东移动转香港'health-check:enable:trueurl:http://wifi.vivo.com.cn/generate_204interval:600HK:type:filepath:./cordcloud.yamlinterval:3600filter:'深港专线'health-check:enable:trueurl:http://wifi.vivo.com.cn/generate_204interval:600TW:type:filepath:./cordcloud.yamlinterval:3600filter:'台湾'health-check:enable:trueurl:http://wifi.vivo.com.cn/generate_204interval:600JP:type:filepath:./cordcloud.yamlinterval:3600filter:'日本'health-check:enable:trueurl:http://wifi.vivo.com.cn/generate_204interval:600SG:type:filepath:./cordcloud.yamlinterval:3600filter:'新加坡'health-check:enable:trueurl:http://wifi.vivo.com.cn/generate_204interval:600US:type:filepath:./cordcloud.yamlinterval:3600filter:'美国'health-check:enable:trueurl:http://wifi.vivo.com.cn/generate_204interval:600proxy-groups:- name:Finaltype:selectproxies:- Proxies- DIRECT- name:Proxiestype:selectproxies:- load_balance- hk_urltest- tw_urltest- sg_urltest- us_urltest- name:StreamSEtype:selectproxies:- load_balance- hk_urltest- tw_urltest- sg_urltest- us_urltest- name:Googletype:selectproxies:- hk_fallback- hk_urltest- tw_urltest- sg_urltest- Proxies- name:Telegramtype:selectproxies:- sg_urltest- hk_urltest- tw_urltest- Proxies- name:load_balancetype:load-balanceurl:http://wifi.vivo.com.cn/generate_204interval:300proxies:use:- HK_LOW- name:hk_urltesttype:url-testurl:http://wifi.vivo.com.cn/generate_204interval:300proxies:use:- HK_LOW- name:hk_fallbacktype:fallbackurl:http://wifi.vivo.com.cn/generate_204interval:300proxies:use:- HK- name:us_urltesttype:url-testurl:http://wifi.vivo.com.cn/generate_204in","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:3:0","tags":["Clash"],"title":"Clash安装与使用","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["Clash"],"content":"TProxy代理设置 采用clash官方推荐的wiki的防火墙设置，来拦截流量，由于udp不支持redir，所以tcp采用redir，udp采用tproxy(也都可以采用tproxy)，dns拦截端口为上述文件设置的1053，将dns的udp查询均转发至1053端口 为了防止clash代理自身流量，有两种常用方式避免流量回环，cgroup和uid。第一种方式将clash加入特定cgroup足，比如自定义的noproxy组，第二种方式为使用clash用户来启动clash进程。接着使用iptables来匹配对于流量 官方推荐wiki的iptables规则如下 #tcp iptables -t nat -N clash iptables -t nat -A clash -d 0.0.0.0/8 -j RETURN iptables -t nat -A clash -d 10.0.0.0/8 -j RETURN iptables -t nat -A clash -d 127.0.0.0/8 -j RETURN iptables -t nat -A clash -d 169.254.0.0/16 -j RETURN iptables -t nat -A clash -d 172.16.0.0/12 -j RETURN iptables -t nat -A clash -d 192.168.0.0/16 -j RETURN iptables -t nat -A clash -d 224.0.0.0/4 -j RETURN iptables -t nat -A clash -d 240.0.0.0/4 -j RETURN iptables -t nat -A clash -p tcp -j REDIRECT --to-port 7892 iptables -t nat -I PREROUTING -p tcp -d 8.8.8.8 -j REDIRECT --to-port 7892 iptables -t nat -I PREROUTING -p tcp -d 8.8.4.4 -j REDIRECT --to-port 7892 iptables -t nat -A PREROUTING -p tcp -j clash iptables -t nat -A OUTPUT -p tcp -d 198.18.0.0/16 -j REDIRECT --to-port 7892 #udp ip rule add fwmark 1 table 100 ip route add local default dev lo table 100 iptables -t mangle -N clash iptables -t mangle -A clash -d 0.0.0.0/8 -j RETURN iptables -t mangle -A clash -d 10.0.0.0/8 -j RETURN iptables -t mangle -A clash -d 127.0.0.0/8 -j RETURN iptables -t mangle -A clash -d 169.254.0.0/16 -j RETURN iptables -t mangle -A clash -d 172.16.0.0/12 -j RETURN iptables -t mangle -A clash -d 192.168.0.0/16 -j RETURN iptables -t mangle -A clash -d 224.0.0.0/4 -j RETURN iptables -t mangle -A clash -d 240.0.0.0/4 -j RETURN iptables -t mangle -A clash -p udp -j TPROXY --on-port 7893 --tproxy-mark 1 iptables -t mangle -A OUTPUT -p udp -d 198.18.0.0/16 -j MARK --set-mark 1 iptables -t mangle -A PREROUTING -p udp -j clash iptables -t nat -N CLASH_DNS iptables -t nat -F CLASH_DNS iptables -t nat -A CLASH_DNS -p udp -j REDIRECT --to-port 1053 iptables -t nat -I OUTPUT -p udp --dport 53 -j CLASH_DNS iptables -t nat -I PREROUTING -p udp --dport 53 -j REDIRECT --to 1053 # 以下二选一 # 使用noproxy的cgroup组来防止流量回环 iptables -t mangle -A OUTPUT -m cgroup --path \"noproxy.slice\" -j RETURN # 使用uid来防止流量回环 # iptables -t mangle -A clash-self -m owner --uid-owner clash -j RETURN ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:4:0","tags":["Clash"],"title":"Clash安装与使用","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["Clash"],"content":"iptables规则持久化 iptables 规则在每次系统重启后，都会进行复原，因此如果设置错误导致无法上网时，可以删除防火墙对应规则或直接重启电脑解决 为了让iptables规则持久化，可以设置一个开机自启服务，自动运行对应脚本以设置防火墙。将上述 iptables 规则保存为为 iptables.sh ，并创建 /etc/systemd/system/tproxy.service，编辑设置内容如下 [Unit] Description=Setup ip-rule and ip-route for tproxy local network traffic. Before=network-pre.target Wants=network-pre.target [Service] Type=oneshot ExecStart=/bin/bash /path/to/iptables.sh RemainAfterExit=yes [Install] WantedBy=multi-user.target 设置服务开机自启 sudo systemctl enable tproxy.service ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:5:0","tags":["Clash"],"title":"Clash安装与使用","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["Clash"],"content":"启动服务 clash 需要部分网络代理能力，编辑 clash@ 服务文件，添加 clash 的 capability 能力， sudo systemctl edit clash@.service 添加如下内容 CapabilityBoundingSet=CAP_NET_ADMIN CAP_NET_BIND_SERVICE AmbientCapabilities=CAP_NET_ADMIN CAP_NET_BIND_SERVICE CAP_NET_RAW 让应用可以处理 TProxy 带来的流量 CAP_NET_BIND_SERVICE 允许应用绑定 1000 以下的端口 如果采用 cgroup 防止流量回环，还需要设置该服务所对应的 Slice，采用 UID 识别的话，则需要设置该服务的启动 USER，二选一即可，也可以同时都设置。若设置 UID 时，必须保证系统存在相应用户名 # cgroup Slice = noproxy.slice # UID User = username 同时设置 clash@$USER 服务后台自动，并立即启动 sudo systemctl enable --now clash@$USER.service ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:6:0","tags":["Clash"],"title":"Clash安装与使用","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["Clash"],"content":"docker流量问题解决 为了解决 cgproxy 代理 bridge 联网的 docker 无法联网问题，需要进行如下而外设置 sysctl -w net.bridge.bridge-nf-call-iptables=0 sysctl -w net.bridge.bridge-nf-call-ip6tables=0 sysctl -w net.bridge.bridge-nf-call-arptables=0 ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:7:0","tags":["Clash"],"title":"Clash安装与使用","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["Clash"],"content":"参考资料 Clash github Wik Unofficial Clash Wiki clash-win-docs-new 容器(docker)桥接(bridge)模式时的代理问题 如何使用 Clash 的 TPROXY 功能进行透明代理 ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:8:0","tags":["Clash"],"title":"Clash安装与使用","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"Archlinux 的KDE桌面系统安装","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/","tags":["archlinux"],"title":"Archlinux桌面系统安装","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"前言 作为主力系统，自然需要桌面系统(DE)。主流DE有KDE和GNOME等，根据个人习惯选择系统。本文主要介绍KDE桌面系统的安装 ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:1:0","tags":["archlinux"],"title":"Archlinux桌面系统安装","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"联网 由于桌面系统还没有安装完成，所以采用iwd和dhcpcd进行网络连接，首先启动iwd和dhcpcd，在使用iwd连接无限网络。iwd参照基础系统安装教程 systemctl start iwd systemctl start dhcpcd ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:2:0","tags":["archlinux"],"title":"Archlinux桌面系统安装","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"准备普通用户 由于桌面系统需要普通用户，故先添加普通用户，并配置相应的权限 useradd -m -G wheel -s /bin/bash username passwd username 配置sudo权限 EDITOR=vim visudo 找到下面该行，并取消注释 #%wheel ALL=(ALL) ALL ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:3:0","tags":["archlinux"],"title":"Archlinux桌面系统安装","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"安装KDE环境 KDE安装有三个包组，plasma-meta、plasma和plasma-desktop。其中plasma和plasma-meta区别为，kde后续增加软件包时，plasma-meta会自动安装，而plasma不会，剩下plasma-desktop只有kde能跑起来最少的软件。推荐使用plasma-meta，防止后续缺少组件。konsole和dolphin分别为kde的常用终端和文件管理 pacman -S plasma-meta konsole dolphin ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:4:0","tags":["archlinux"],"title":"Archlinux桌面系统安装","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"启用DM kde默认自带sddm，可以根据需要更换 systemctl enable sddm ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:5:0","tags":["archlinux"],"title":"Archlinux桌面系统安装","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"启用网络管理组件 kde和gnome桌面系统一般采用NetworkManager进行网络管理 systemctl enable NetworkManager ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:6:0","tags":["archlinux"],"title":"Archlinux桌面系统安装","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"重启进入桌面系统 自此，基本的桌面系统已经安装完成，可以重启进入桌面系统 reboot ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:7:0","tags":["archlinux"],"title":"Archlinux桌面系统安装","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"AUR Helper安装 yay和paru是较为常用的aur helper组件，根据个人习惯进行选择 注：由于安装需要从github拉取文件，需要配置代理才可以进行 git clone https://aur.archlinux.org/yay.git cd yay makepkg -si ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:8:0","tags":["archlinux"],"title":"Archlinux桌面系统安装","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"输入法安装 facitx5为社区推荐输入法，安装facitx5 sudo pacman -S fcitx5-im sudo pacman -S fcitx5-chinese-addons fcitx5-pinyin-zhwiki fcitx5-material-colo 配置环境，konsole和dolphin需要环境变量的支持才可以使用输入法，使用EDITOR=vim sudoedit /etc/environment进行添加环境变量 GTK_IM_MODULE=fcitx QT_IM_MODULE=fcitx XMODIFIERS=@im=fcitx SDL_IM_MODULE=fcitx ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:9:0","tags":["archlinux"],"title":"Archlinux桌面系统安装","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"配置默认编辑器 arch默认编辑器为vi，一般使用vim，使用EDITOR=vim sudoedit /etc/profile配置环境变量 export EDITOR='vim' ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:10:0","tags":["archlinux"],"title":"Archlinux桌面系统安装","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"蓝牙配置 安装并配置蓝牙 sudo pacman -S bluez bluez-utils pulseaudio-bluetooth pavucontrol pulseaudio-alsa yay -S bluez-firmware sudo systemctl enable bluetooth.service sudo systemctl start bluetooth.service pulseaudio -k pulseaudio --start sudo usermod -a -G lp $USER 设置蓝牙自启，编辑/etc/bluetooth/main.conf文件，更改AutoEnable的值为true sudo vim /etc/bluetooth/main.conf ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:11:0","tags":["archlinux"],"title":"Archlinux桌面系统安装","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"KDE安装完成 自此，arch的KDE系统基本完成安装。 KDE是可以根据自己的需要进行高度定制化，可以根据自己的需要进行定制化 ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:12:0","tags":["archlinux"],"title":"Archlinux桌面系统安装","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"参考资料 Archlinux Installation guide Arch Linux 安装使用教程 - ArchTutorial - Arch Linux Studio 2021 Archlinux双系统安装教程（超详细） Arch Linux Monthly Install: January 2022 ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:13:0","tags":["archlinux"],"title":"Archlinux桌面系统安装","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"Archlinux 的基本安装","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/","tags":["archlinux"],"title":"Archlinux的基础系统安装流程","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"前言 第一次使用linux系统，查询linux各个版本的区别，最后看上了arch的aur，故选择arch作为主力linux系统(人的生命在于折腾，折腾就完事了) 这篇主要记录了基本系统的安装，不包含桌面系统 ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:1:0","tags":["archlinux"],"title":"Archlinux的基础系统安装流程","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"EFI模式验证 首先确认安装模式是否为EFI模式 ls /sys/firmware/efi/efivars ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:2:0","tags":["archlinux"],"title":"Archlinux的基础系统安装流程","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"系统时钟校正 timedatectl set-ntp true ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:3:0","tags":["archlinux"],"title":"Archlinux的基础系统安装流程","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"进行网络连接 arch系统网络连接方式主要有两种，有线连接和无线连接 ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:4:0","tags":["archlinux"],"title":"Archlinux的基础系统安装流程","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"有线连接 可以使用手机线与电脑进行连接，进行网络共享 ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:4:1","tags":["archlinux"],"title":"Archlinux的基础系统安装流程","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"无线连接 arch live系统默认为开启iwd,使用iwd进行无线网络连接 iwctl device list station wlan0 get-networks station waln0 connect WIFI-NAME 首先进入iwctl模式，查询当前设备无线网卡设备名,比如wlan0），再使用网卡查询当前wifi网络情况，最后对目标WIFI-NAME进行连接，提示输入密码进行确认 ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:4:2","tags":["archlinux"],"title":"Archlinux的基础系统安装流程","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"数据分区及格式化 ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:5:0","tags":["archlinux"],"title":"Archlinux的基础系统安装流程","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"分区 常见分区工具有cfdisk,gdisk等。为了方便，可以使用GUI的cfdisk进行分区 为了防止某些异常，优先对efi进行分区，大小500M～1G即可 剩下分区方式根据个人习惯进行。 比以将home分区单独分区，缺点是home分区和其他分区大小需要控制好，防止某分区空间爆满而需要对文件系统挪动， 将剩余分区大小划分为一个分区，缺点是重装系统麻烦 为了节省存储空间，故采用第二种方式。分区完成后，对主分区进行加密(Optional) ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:5:1","tags":["archlinux"],"title":"Archlinux的基础系统安装流程","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"加密(可选) 为了保证自己的数据安全，可以对主要分区内容进行加密，防止他人挂载直接进入系统读取文件。 使用LUKS对主分区进行加密，没有特殊要求采用默认参数即可 默认使用手动输入密码对文件进行加密 cryptsetup -y -v luksFormat /path/to/device 使用keyfile对文件进行加密 首先生成所需要的keyfile文件，根据生成keyfile文件的类型不同，可以分为密码方式和随机字符或二进制。 为了简便，采用密码对文件进行加密，并将密码制作为keyfile,用作开机自动解密。 echo -n 'your_passphrase' \u003e /etc/keyfile chown root:root /etc/keyfile; chmod 400 /etc/keyfile 解密分区 cryptroot 为解密后对应的文件名，可以自定义 cryptsetup open /path/to/device/ cryptroot ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:5:2","tags":["archlinux"],"title":"Archlinux的基础系统安装流程","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"格式化 efi分区采用mkfs.fat进行格式化。主分区根据不同的文件类型特性进行选择格式化，比如mkfs.ext4格式化为ext4,mkfs.btrfs格式化为btrfs，其中ext4速度整体快于btrfs,而btrfs存在快照等特性。 mkfs.fat -F 32 /path/to/efi mkfs.ext4 /path/to/device ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:5:3","tags":["archlinux"],"title":"Archlinux的基础系统安装流程","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"挂载分区，并安装基本软件 先挂载/mnt分区，在创建/mnt/boot分区，并挂载(也可以创建/mnt/efi分区并进行挂载，二者不同之处可以查看archwiki) mount /dev/mapper/cryptroot /mnt mount /path/to/efi /mnt/boot 其中cryptroot为解密后分区所对应的名字，挂载时需要选择解密后的分区名 使用pacstarp在/mnt分区中安装基本软件，并生成分区文件，最后进入安装系统(根据电脑CPU类型安装所需要的微码，intel的cpu安装intel-ucode，amd的安装amd-ucode) pacstarp /mnt base base-devel linux linux-headers linux-firmware sudo amd-ucode genfstab -U /mnt \u003e\u003e /mnt/etc/fstab arch-chroot /mnt ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:6:0","tags":["archlinux"],"title":"Archlinux的基础系统安装流程","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"更改镜像源并启用32位库 由于国外镜像站网速限制，可以使用国内教育镜像站进行加速，镜像配置文件为/etc/pacman.d/mirrorlist，可以设置多个镜像站 Server = https://mirrors.ustc.edu.cn/archlinux/$repo/os/$arch 由于部分软件需要32位库，比如wine,而默认32位库是注释掉了，需要取消注释才能启用，不需要32位软件的可以不进行该操作。pacman的默认库文件位/etc/pacman.conf，取消注释multilib库 [multilib] Server = /etc/pacman.d/mirrorlist ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:7:0","tags":["archlinux"],"title":"Archlinux的基础系统安装流程","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"修改密码 修改root的密码 passwd ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:8:0","tags":["archlinux"],"title":"Archlinux的基础系统安装流程","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"基础软件安装 安装基础软件，比如网络，编辑器等 pacman -S networkmanager vim git wget curl dhcpcd iwd bash-completion dialog wpa_supplicant ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:9:0","tags":["archlinux"],"title":"Archlinux的基础系统安装流程","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"时区和区域设置 使用软链设置时区，比如设置位亚洲的上海时区，并同步 ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime hwclock --systohc 区域设置，对应文件位/etc/locale.gen，编辑并取消所需要的区域设置，并生成对应文件 vim /etc/locale.gen # 取消en_US.UTF-8和zh_CN.UTF-8的注销 locale-gen 向/etc/locale.conf导入本地语言设置，防止乱码 echo 'LANG=en_US.UTF-8' \u003e /etc/locale.conf ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:10:0","tags":["archlinux"],"title":"Archlinux的基础系统安装流程","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"主机名设置 编辑/etc/hostname，设置主机名，比如arch，并根据主机名设置host文件 echo arch \u003e /etc/hostname cat \u003e /etc/hosts \u003c\u003cEOF 127.0.0.1 localhost ::1 localhost 127.0.1.1 arch.localdomain arch EOF ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:11:0","tags":["archlinux"],"title":"Archlinux的基础系统安装流程","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"安装引导文件 引导文件有grub和system-boot，system-boot需要手动写入启动文件，grub指令可以直接生成，较为方便，故采用grub(若efi分区挂载为/mnt/efi，则将efi-directory更改为/efi) pacman -S grub efibootmgr grub-install --target=x86_64-efi --efi-directory=/boot --bootloader-id=GRUB grub-mkconfig -o /boot/grub/grub.cfg ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:12:0","tags":["archlinux"],"title":"Archlinux的基础系统安装流程","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"解密参数配置(可选) 如果对磁盘设置了加密，必须设置一些hook和内核参数来告诉内核加密磁盘的位置 具体操作可以参见Archlinux自动解密磁盘 ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:13:0","tags":["archlinux"],"title":"Archlinux的基础系统安装流程","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"完成安装 基本系统已经完成安装，退出系统，并取消文件挂载，重启既可以进入安装好的系统 exit umount -a reboot ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:14:0","tags":["archlinux"],"title":"Archlinux的基础系统安装流程","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":["archlinux"],"content":"参考资料 Archlinux Installation guide dm-crypt/Encrypting an entire system Arch Linux 安装使用教程 - ArchTutorial - Arch Linux Studio Arch Linux 搭建 java 开发环境 2021 Archlinux双系统安装教程（超详细） Arch Linux Monthly Install: January 2022 ","date":"2022-03-07","objectID":"/posts/archlinux%E5%AE%89%E8%A3%85.html/:15:0","tags":["archlinux"],"title":"Archlinux的基础系统安装流程","uri":"/posts/archlinux%E5%AE%89%E8%A3%85.html/"},{"categories":null,"content":"游戏规则 点击小圆点，围住小猫。 你点击一次，小猫走一次。 直到你把小猫围住（赢），或者小猫走到边界并逃跑（输）。 ","date":"0001-01-01","objectID":"/catch-the-cat/:1:0","tags":null,"title":"逮住那只猫!","uri":"/catch-the-cat/"}]