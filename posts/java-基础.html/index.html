<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>Java 基础 - Luckyouo Blog</title><meta name=Description content="Java 常用小技巧"><meta property="og:title" content="Java 基础"><meta property="og:description" content="Java 常用小技巧"><meta property="og:type" content="article"><meta property="og:url" content="https://luckyouo.github.io/posts/java-%E5%9F%BA%E7%A1%80.html/"><meta property="og:image" content="https://luckyouo.github.io/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-03-21T15:33:45+08:00"><meta property="article:modified_time" content="2023-02-03T16:58:11+08:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://luckyouo.github.io/logo.png"><meta name=twitter:title content="Java 基础"><meta name=twitter:description content="Java 常用小技巧"><meta name=application-name content="LoveIt"><meta name=apple-mobile-web-app-title content="LoveIt"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://luckyouo.github.io/posts/java-%E5%9F%BA%E7%A1%80.html/><link rel=prev href=https://luckyouo.github.io/posts/manacher-%E7%AE%97%E6%B3%95.html/><link rel=next href=https://luckyouo.github.io/posts/%E5%8F%8C%E6%8C%87%E9%92%88.html/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Java 基础","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/luckyouo.github.io\/posts\/java-%E5%9F%BA%E7%A1%80.html\/"},"genre":"posts","keywords":"java","wordcount":3559,"url":"https:\/\/luckyouo.github.io\/posts\/java-%E5%9F%BA%E7%A1%80.html\/","datePublished":"2022-03-21T15:33:45+08:00","dateModified":"2023-02-03T16:58:11+08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"luckyouo"},"description":"Java 常用小技巧"}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><a href=https://github.com/luckyouo class=github-corner target=_blank title="Follow me on GitHub" aria-label="Follow me on GitHub"><svg width="3.5rem" height="3.5rem" viewBox="0 0 250 250" style="fill:#70b7fd;color:#fff;position:absolute;top:0;border:0;left:0;transform:scale(-1,1)" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><div class=header-title><a href=/ title="Luckyouo Blog">Luckyouo Blogs</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>归档 </a><a class=menu-item href=/tags/>标签 </a><a class=menu-item href=/categories/>分类 </a><a class=menu-item href=/friends/><i class='fas fa-fw fa-fan fa-spin'></i> 友链 </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder=搜索文章标题或内容... id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Luckyouo Blog">Luckyouo Blogs</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容... id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></div><a class=menu-item href=/posts/ title>归档</a><a class=menu-item href=/tags/ title>标签</a><a class=menu-item href=/categories/ title>分类</a><a class=menu-item href=/friends/ title><i class='fas fa-fw fa-fan fa-spin'></i>友链</a><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class="toc-content always-active" id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">Java 基础</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>luckyouo</a></span>&nbsp;<span class=post-category>收录于 <a href=/categories/java/><i class="far fa-folder fa-fw"></i>Java</a></span></div><div class=post-meta-line><i class="far fa-calendar fa-fw"></i>&nbsp;<time datetime=2022-03-21>2022-03-21</time>&nbsp;<i class="far fa-calendar-plus fa-fw"></i>&nbsp;<time datetime=2023-02-03>2023-02-03</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 3559 字&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 8 分钟&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ol><li><a href=#前言>前言</a></li><li><a href=#内容>内容</a><ol><li><a href=#字符串拼接>字符串拼接</a></li><li><a href=#comparator-类的-compare-方法重写>Comparator 类的 compare 方法重写</a></li><li><a href=#数组填充>数组填充</a></li><li><a href=#集合元素添加>集合元素添加</a></li><li><a href=#arraysaslist-注意事项>Arrays.asList 注意事项</a></li><li><a href=#基本数据类型排序>基本数据类型排序</a></li><li><a href=#hashset-去重>HashSet 去重</a></li><li><a href=#stringbuilder-插入>StringBuilder 插入</a></li><li><a href=#final-关键字>final 关键字</a></li><li><a href=#tostring>toString</a></li><li><a href=#数组转-string>数组转 String</a></li><li><a href=#双浮点数除法精确度>双浮点数除法精确度</a></li><li><a href=#mathceil>Math.ceil</a></li><li><a href=#systemarraycopy-和-arrayscopyof>System.arraycopy 和 Arrays.copyOf</a></li><li><a href=#内存存储>内存存储</a></li><li><a href=#数组>数组</a></li><li><a href=#局部变量>局部变量</a></li><li><a href=#arraysbinarysearch>Arrays.binarySearch</a></li><li><a href=#int-乘法溢出问题>int 乘法溢出问题</a></li><li><a href=#for-循环应尽量遵循外小内大原则>for 循环应尽量遵循外小内大原则</a></li><li><a href=#for-循环应该消除判断终止时的方法调用>for 循环应该消除判断终止时的方法调用</a></li><li><a href=#java-的取模运算>Java 的取模运算</a></li><li><a href=#java-超-int>java 超 int</a></li></ol></li></ol></nav></div></div><div class=content id=content><h2 id=前言>前言</h2><p>主要总结一些 <code>java</code> 的基本使用</p><p>持续总结中 <code>ing</code></p><h2 id=内容>内容</h2><h3 id=字符串拼接>字符串拼接</h3><p>字符串的拼接优先使用StringBuilder和StringBuffer类，同时在使用拼接的过程中，尽量使用一个一个的字符串进行 <code>append</code> ，而不是将某些字符串拼接后再 <code>append</code> ，例如</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kt>int</span> <span class=n>n</span> <span class=o>=</span> <span class=mi>100</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=n>StringBuilder</span> <span class=n>sb</span> <span class=o>=</span> <span class=k>new</span> <span class=n>StringBuilder</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>n</span><span class=o>;</span> <span class=n>i</span><span class=o>++){</span>
</span></span><span class=line><span class=cl>    <span class=err>#</span> <span class=n>sb</span><span class=o>.</span><span class=na>append</span><span class=o>(</span><span class=n>i</span> <span class=o>+</span> <span class=s>&#34;#&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>sb</span><span class=o>.</span><span class=na>append</span><span class=o>(</span><span class=n>i</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>sb</span><span class=o>.</span><span class=na>append</span><span class=o>(</span><span class=s>&#34;#&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>不要将 <code>i + "#"</code> 拼接好后在 <code>append</code> ，字符串拼接后会产生的新的字符串从而产生更多的开销</p><h3 id=comparator-类的-compare-方法重写>Comparator 类的 compare 方法重写</h3><p>当需要在某数组某区间进行排序并且需要逆序是，则可以重写 <code>static &lt;T> void sort(T[] a, int fromIndex, int toIndex, Comparator&lt;? super T> c)</code> 方法，该方法返回类型为泛型，所以不能使用基本类型数组进行接受（数组泛型不会自动解包操作），需要使用包装类完成类型接受。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>mySort</span><span class=o>(</span><span class=n>Integer</span><span class=o>[]</span> <span class=n>nums</span><span class=o>,</span> <span class=kt>int</span> <span class=n>idx</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>	<span class=n>Arrays</span><span class=o>.</span><span class=na>sort</span><span class=o>(</span><span class=n>nums</span><span class=o>,</span> <span class=mi>0</span><span class=o>,</span> <span class=n>idx</span><span class=o>,</span> <span class=o>(</span><span class=n>a</span><span class=o>,</span> <span class=n>b</span><span class=o>)</span> <span class=o>-&gt;</span> <span class=n>Integer</span><span class=o>.</span><span class=na>compare</span><span class=o>(</span><span class=n>b</span><span class=o>,</span> <span class=n>a</span><span class=o>));</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=数组填充>数组填充</h3><p>int double long 数组的默认初始化是 <code>0</code>， boolean 数组默认初始化为 <code>false</code> ，类的数组初始化为 <code>null</code>。 若需要对数组全部进行填充时，可以使用Arrays <code>api</code>完成，比如将 int 数组 arr 初始化为 -1。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Arrays</span><span class=o>.</span><span class=na>fill</span><span class=o>(</span><span class=n>arr</span><span class=o>,</span> <span class=o>-</span><span class=mi>1</span><span class=o>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=集合元素添加>集合元素添加</h3><p>当往集合中添加非基本类型元素时，因为非基本类型元素是引用类型，若引用类型发生改变，则集合元素也会发生改变。所以，没有特别要求时，集合添加元素时，需要额外创建一个引用类型进行添加，以区分之前的引用元素。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>set</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;(</span><span class=n>list</span><span class=o>));</span>
</span></span></code></pre></td></tr></table></div></div><p>当直接添加引用元素时，引用元素修改，集合元素也发生修改</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>set</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>list</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>list</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=mi>12</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=c1>// set 中的 list 会增加 12 元素
</span></span></span></code></pre></td></tr></table></div></div><h3 id=arraysaslist-注意事项>Arrays.asList 注意事项</h3><ol><li>将数组转换为 List 时，<code>Arrays.asList</code> 生成的 <code>list</code> 长度是固定的，内容结构不可变更（不可以使用add、remove，但是可以使用 set），但内部数据可以发生变更，且生成的 list 底层结构仍然是数组，是对数组的引用，若生成的 list 数据发生变更，则数组对应的数组也会变更。</li><li>当基本类型转换时，需要使用包装类完成。若使用基本类型时，比如 <code>int</code> ，则生成的 <code>list</code> 的类型为 <code>int[]</code> 。因为 <code>Arrays.asList</code> 的实现是通过泛型完成，而基本类型是不可以泛化的，而基本类型的数组是可以泛化的，所以生成的的 <code>list</code> 的类型为基本类型数组。若需要使用基本类型的 <code>list</code> ，则应该使用基本类型对应的包装类数组完成转换，比如 <code>Integer[]</code> 数组。</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.Arrays</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>java.util.List</span><span class=o>;</span>
</span></span><span class=line><span class=cl> 
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Test</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>){</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span><span class=o>[]</span> <span class=n>nums</span> <span class=o>=</span> <span class=o>{</span><span class=mi>1</span><span class=o>,</span> <span class=mi>2</span><span class=o>,</span> <span class=mi>3</span><span class=o>};</span>
</span></span><span class=line><span class=cl>        <span class=n>List</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>[]&gt;</span> <span class=n>list1</span> <span class=o>=</span> <span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span><span class=n>nums</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=n>Integer</span><span class=o>[]</span> <span class=n>nums1</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Integer</span><span class=o>[]{</span><span class=mi>1</span><span class=o>,</span><span class=mi>2</span><span class=o>,</span><span class=mi>3</span><span class=o>};</span>
</span></span><span class=line><span class=cl> 		<span class=n>List</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>list1</span> <span class=o>=</span> <span class=n>Arrays</span><span class=o>.</span><span class=na>asList</span><span class=o>(</span><span class=n>nums1</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>参考：<a href=https://www.jianshu.com/p/52cdcec633bd target=_blank rel="noopener noreffer">Arrays.asList() 详解</a></p><h3 id=基本数据类型排序>基本数据类型排序</h3><p>java 的内部排序默认是快排，数据是从大到小，但当需要从小到大时，需要重写 <code>Comparator</code> 接口方法。但如果是基本数据类型数组，因为基本类型不属于类，所有没有办法利用泛型重写 <code>Comparator</code> 接口方法。解决方法如下：</p><ol><li>自己手写一个排序</li><li>利用 java8 的流特性进行反转</li><li>内部排序之后再逆转</li><li>将 int[] 数组转换为 Integer[] 数组，利用包装类进行排序。（不能直接强制类型转换，只能循环复制，利用自动装箱和拆箱机机制）</li></ol><p>参考：<a href=https://segmentfault.com/q/1010000011728359 target=_blank rel="noopener noreffer">怎么进行java数组逆序排序？</a></p><h3 id=hashset-去重>HashSet 去重</h3><p>HashSet 是无序不可重复的集合，线程不安全的，底层基于HashMap，基于hashCode()。判断重复机制首先判断添加的元素的 hashCode() 是否相同，再通过 equals() 方法判断元素是否相等。</p><p>当使用 HashSet 去重 Integer[] 等数组元素时，如果每次都是通过 new 添加元素，而Integr[] 数组对象没有重写 hashCode 和 equals 方法，故无法达到去重的效果</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>HashSet</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>[]&gt;</span> <span class=n>set</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HashSet</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl><span class=n>set</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=k>new</span> <span class=n>Integer</span><span class=o>[]{</span><span class=mi>1</span><span class=o>,</span> <span class=mi>2</span><span class=o>});</span>
</span></span><span class=line><span class=cl><span class=n>set</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=k>new</span> <span class=n>Integer</span><span class=o>[]{</span><span class=mi>1</span><span class=o>,</span><span class=mi>2</span> <span class=o>});</span> <span class=c1>// 无法去重，因为 new 出来的对象 hashcode 不同，而 equals 方法默认是比较两个对象的地址，故也不同。
</span></span></span></code></pre></td></tr></table></div></div><p>而 HashSet 去重 Collection 元素时，即使通过 new 创建一个对象，但 Collection 都已经重写了 hashCode 和 equals 方法，故可以去重。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>HashSet</span><span class=o>&lt;</span><span class=n>List</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;&gt;</span> <span class=n>set</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HashSet</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl><span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>list</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl><span class=n>list</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=mi>1</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>list</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=mi>2</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>set</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;(</span><span class=n>list</span><span class=o>));</span>
</span></span><span class=line><span class=cl><span class=n>set</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;(</span><span class=n>list</span><span class=o>));</span> <span class=c1>// set size 仍为 1
</span></span></span></code></pre></td></tr></table></div></div><h3 id=stringbuilder-插入>StringBuilder 插入</h3><p>使用 StringBuilder 底层的数据结构为字符数组，所以当执行频繁的插入操作时，尽量使用 append 方法在尾部插入。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Deque</span><span class=o>&lt;</span><span class=n>Character</span><span class=o>&gt;</span> <span class=n>stack</span> <span class=o>=</span> <span class=k>new</span> <span class=n>LinkedList</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=o>(!</span><span class=n>stack</span><span class=o>.</span><span class=na>isEmpty</span><span class=o>()){</span>
</span></span><span class=line><span class=cl>    <span class=n>sb</span><span class=o>.</span><span class=na>append</span><span class=o>(</span><span class=n>stack</span><span class=o>.</span><span class=na>pollFirst</span><span class=o>());</span>
</span></span><span class=line><span class=cl>    <span class=c1>// sb.insert(0, stack.pollLast());
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=final-关键字>final 关键字</h3><p>final 定义的变量是不可以变的量，指的是变量不能更改对象引用，但是引用的对象内容是可以变更的。比如用 final 修饰 list 时，list的内容仍然可以发生变更，但使用 final 修饰基本类型或者包装类时，则变量对应的就是基本数据，不可以发生变更，否则编译异常。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>final</span> <span class=n>Integer</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>i</span> <span class=o>+=</span> <span class=mi>1</span><span class=o>;</span> <span class=c1>// 编译不通过
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kd>final</span> <span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>Integer</span><span class=o>&gt;</span> <span class=n>list</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl><span class=n>list</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=mi>2</span><span class=o>);</span> <span class=c1>// 编译通过
</span></span></span></code></pre></td></tr></table></div></div><h3 id=tostring>toString</h3><p>在将对象输出时，会自动调用对象的 toString 方法。如果想利用 toString 方法打印对象地址，不能使用 this 来打印对象地址，而需要使用 <code>Object.toString()</code> 方法，即使用 <code>super.toString()</code> ，否则会出现循环调用，因为 this 对象也表示该对象，即对象再次调用自己的 toString 方法。</p><h3 id=数组转-string>数组转 String</h3><p>Arrays.toString 方法是用来将一维数组转换 String。多为数组使用 Arrays.deepToString。</p><h3 id=双浮点数除法精确度>双浮点数除法精确度</h3><p>当使用两个浮点数进行除法时，可能会出现结果与预期不一致的问题，其原因是使用浮点数无法正确表示某些小数，所以尽量减少使用浮点数做除法。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kt>double</span> <span class=n>v1</span> <span class=o>=</span> <span class=mf>0.7</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kt>double</span> <span class=n>v2</span> <span class=o>=</span> <span class=mf>0.025</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kt>double</span> <span class=n>result</span> <span class=o>=</span> <span class=n>v1</span> <span class=o>/</span> <span class=n>v2</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>result</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=c1>// 27.999999999999996 而不是预期的 28
</span></span></span></code></pre></td></tr></table></div></div><h3 id=mathceil>Math.ceil</h3><p>该方法主要作用是对一个浮点数向上取整。但是如果是对除法结果向上取整时，在 java 中除法的结果已经对结果向下取整了，即结果已经是一个整数，故与预期结果不一致。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kt>int</span> <span class=n>x</span> <span class=o>=</span> <span class=mi>16</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>y</span> <span class=o>=</span> <span class=mi>3</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>ans</span> <span class=o>=(</span><span class=kt>int</span><span class=o>)</span> <span class=n>Math</span><span class=o>.</span><span class=na>ceil</span><span class=o>(</span><span class=n>x</span> <span class=o>/</span> <span class=n>y</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>ans</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=c1>// 5 而不是预期的 6
</span></span></span></code></pre></td></tr></table></div></div><p>解决办法有三种：</p><ol><li>改为浮点数除法，这样结果即为浮点数，在对其向上取整。弊端是存在双浮点数除法存在精度异常问题，需要注意使用</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kt>int</span> <span class=n>ans</span> <span class=o>=(</span><span class=kt>int</span><span class=o>)</span> <span class=n>Math</span><span class=o>.</span><span class=na>ceil</span><span class=o>((</span><span class=kt>double</span><span class=o>)</span><span class=n>x</span> <span class=o>/</span> <span class=n>y</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>ans</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=c1>// 6
</span></span></span></code></pre></td></tr></table></div></div><ol start=2><li>利用模运算，若取余结果不为 0，则对除法结果进一</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kt>int</span> <span class=n>ans</span> <span class=o>=</span> <span class=n>x</span> <span class=o>/</span> <span class=n>y</span> <span class=o>+</span> <span class=o>((</span><span class=n>x</span> <span class=o>%</span> <span class=n>y</span><span class=o>)</span> <span class=o>==</span> <span class=mi>0</span> <span class=o>?</span> <span class=mi>0</span> <span class=o>:</span> <span class=mi>1</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>ans</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=c1>// 6
</span></span></span></code></pre></td></tr></table></div></div><ol start=3><li>利用加法的一些技巧</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kt>int</span> <span class=n>ans</span> <span class=o>=</span> <span class=o>(</span><span class=n>x</span> <span class=o>+</span> <span class=n>y</span> <span class=o>-</span> <span class=mi>1</span><span class=o>)</span> <span class=o>/</span> <span class=n>y</span><span class=o>;</span> <span class=c1>// 该情况不适用于 y &lt; 0
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>ans</span> <span class=o>=</span> <span class=o>(</span><span class=n>x</span> <span class=o>-</span> <span class=mi>1</span><span class=o>)</span> <span class=o>/</span> <span class=n>y</span> <span class=o>+</span> <span class=mi>1</span><span class=o>;</span> <span class=c1>// 该情况不适用于 a=0 和 b&lt;1
</span></span></span></code></pre></td></tr></table></div></div><p><a href=https://stackoverflow.com/questions/7139382/java-rounding-up-to-an-int-using-math-ceil target=_blank rel="noopener noreffer">Java rounding up to an int using Math.ceil</a></p><h3 id=systemarraycopy-和-arrayscopyof>System.arraycopy 和 Arrays.copyOf</h3><p>二者对数组的拷贝方式都是浅拷贝。调用 <code>list.toArray(T[])</code> 方法时，当传递的数组大小小于集合长度时，调用 <code>Arrays.copyOf</code> 方法进行拷贝，反之，则调用 <code>System.arraycopy</code> 进行拷贝。<code>Arrays.copyOf</code> 底层仍然是调用 <code>System.copyarray</code> 方法进行拷贝。故集合的 <code>toArray(T[])</code> 方法也为浅拷贝。</p><p><strong>注意集合中的 toArray() 方法也是浅拷贝</strong></p><h3 id=内存存储>内存存储</h3><p>使用 new 关键字创建的对象都是存储在堆内存中的，而基本类型都是存储在栈上的，分配和清理堆相对于栈要花费更多的时间，但 java 内部已经进行了足够的优化，</p><h3 id=数组>数组</h3><p>不管使用什么类型的数组，存储的都是堆上对象的引用，因为数组可以显示的通过 new 进行创建，也可也隐式的通过 new 创建。对象数组和基元数组在使用上是完全相同的。唯一的不同之处就是对象数组存储的是对象的引用，而<strong>基元数组则直接存储基本数据类型的值</strong>。</p><h3 id=局部变量>局部变量</h3><p>java 和 C++ 不一样，不支持同名的局部变量，即没有同名变量</p><h3 id=arraysbinarysearch>Arrays.binarySearch</h3><p>$java$ 内部 $Arrays$ 默认实现的二分查找是根据<strong>递增顺序</strong> 的二分查找，若需要使用逆序或者自定义排序时，则需要传入 $Comparator$ 对象，但这只支持泛型数组，由于泛型数组不能接受基本数据类型数组，所以基本类型数组不能使用该方法，基本类则可以使用。</p><p>该二分查找使用的是中间随机二分查找，因此，若数组出现重复元素时，不保证查询顺序。若查询的数据不再数组中时，则返回 $-(1 + index) $ ，其中 index 会插入位置。</p><p>之所以返回 $-(1 + index) $ ，而不是 $-index$ ，是为了区别 $0$，即区别查找的元素正好为第一个元素和需要插入在一个元素前，否则二者返回结果都是 $0$。</p><h3 id=int-乘法溢出问题>int 乘法溢出问题</h3><p>当两个 int 类型相乘时，如果结果溢出，需要先将 int 作为 long，在进行乘法，否则两个 int 相乘结果已经溢出，再转 long，结果仍然为溢出结果。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>n</span> <span class=o>=</span> <span class=mi>100000</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>n</span> <span class=o>*</span> <span class=o>(</span><span class=n>n</span> <span class=o>-</span> <span class=mi>1</span><span class=o>));</span>
</span></span><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>((</span><span class=kt>long</span><span class=o>)</span> <span class=n>n</span> <span class=o>*</span> <span class=o>(</span><span class=n>n</span> <span class=o>-</span><span class=mi>1</span><span class=o>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 1409965408
</span></span></span><span class=line><span class=cl><span class=c1>// 9999900000
</span></span></span></code></pre></td></tr></table></div></div><h3 id=for-循环应尽量遵循外小内大原则>for 循环应尽量遵循外小内大原则</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>stratTime</span> <span class=o>=</span> <span class=n>System</span><span class=o>.</span><span class=na>nanoTime</span><span class=o>();</span>  
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span><span class=mi>10000</span> <span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>  
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=mi>100</span><span class=o>;</span> <span class=n>j</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=mi>10</span><span class=o>;</span> <span class=n>k</span><span class=o>++)</span> <span class=o>{</span>  
</span></span><span class=line><span class=cl>            <span class=n>testFunction</span><span class=o>(</span><span class=n>i</span><span class=o>,</span> <span class=n>j</span><span class=o>,</span> <span class=n>k</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;外大内小耗时：&#34;</span><span class=o>+</span> <span class=o>(</span><span class=n>endTime</span> <span class=o>-</span> <span class=n>stratTime</span><span class=o>));</span>  
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>stratTime</span> <span class=o>=</span> <span class=n>System</span><span class=o>.</span><span class=na>nanoTime</span><span class=o>();</span>  
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span><span class=mi>10</span> <span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>  
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=mi>100</span><span class=o>;</span> <span class=n>j</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=mi>10000</span><span class=o>;</span> <span class=n>k</span><span class=o>++)</span> <span class=o>{</span>  
</span></span><span class=line><span class=cl>            <span class=n>testFunction</span><span class=o>(</span><span class=n>i</span><span class=o>,</span> <span class=n>j</span><span class=o>,</span> <span class=n>k</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=n>endTime</span> <span class=o>=</span> <span class=n>System</span><span class=o>.</span><span class=na>nanoTime</span><span class=o>();</span>  
</span></span><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;外小内大耗时：&#34;</span><span class=o>+(</span><span class=n>endTime</span> <span class=o>-</span> <span class=n>stratTime</span><span class=o>));</span> 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 外大内小耗时：1582127649  
</span></span></span><span class=line><span class=cl><span class=c1>// 外小内大耗时：761666633  
</span></span></span></code></pre></td></tr></table></div></div><p>由于内循环通常会存在创建对象对象的情况，所以外循环越小，创建对象的次数也就越少，也可以将对象创建放置在循环外，这样可以进一步减少时间。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>stratTime</span> <span class=o>=</span> <span class=n>System</span><span class=o>.</span><span class=na>nanoTime</span><span class=o>();</span>  
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>i</span><span class=o>,</span> <span class=n>j</span><span class=o>,</span> <span class=n>k</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=o>(</span><span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span><span class=mi>10</span> <span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>  
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=o>(</span><span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=mi>100</span><span class=o>;</span> <span class=n>j</span><span class=o>++)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=o>(</span><span class=n>k</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>k</span> <span class=o>&lt;</span> <span class=mi>10000</span><span class=o>;</span> <span class=n>k</span><span class=o>++)</span> <span class=o>{</span>  
</span></span><span class=line><span class=cl>            <span class=n>testFunction</span><span class=o>(</span><span class=n>i</span><span class=o>,</span> <span class=n>j</span><span class=o>,</span> <span class=n>k</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span><span class=line><span class=cl><span class=n>endTime</span> <span class=o>=</span> <span class=n>System</span><span class=o>.</span><span class=na>nanoTime</span><span class=o>();</span>  
</span></span><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;提取出循环内变量后耗时：&#34;</span><span class=o>+(</span><span class=n>endTime</span> <span class=o>-</span> <span class=n>stratTime</span><span class=o>))</span>
</span></span><span class=line><span class=cl><span class=c1>// 外小内大耗时：761666633  
</span></span></span><span class=line><span class=cl><span class=c1>// 提取出循环内变量后耗时：748479323
</span></span></span></code></pre></td></tr></table></div></div><h3 id=for-循环应该消除判断终止时的方法调用>for 循环应该消除判断终止时的方法调用</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>stratTime</span> <span class=o>=</span> <span class=n>System</span><span class=o>.</span><span class=na>nanoTime</span><span class=o>();</span>  
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>list</span><span class=o>.</span><span class=na>size</span><span class=o>();</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>  
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl><span class=o>}</span>  
</span></span><span class=line><span class=cl><span class=n>endTime</span> <span class=o>=</span> <span class=n>System</span><span class=o>.</span><span class=na>nanoTime</span><span class=o>();</span>  
</span></span><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;未优化list耗时：&#34;</span><span class=o>+(</span><span class=n>endTime</span> <span class=o>-</span> <span class=n>stratTime</span><span class=o>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 优化后
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=n>stratTime</span> <span class=o>=</span> <span class=n>System</span><span class=o>.</span><span class=na>nanoTime</span><span class=o>();</span>  
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>size</span> <span class=o>=</span> <span class=n>list</span><span class=o>.</span><span class=na>size</span><span class=o>();</span>  
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>size</span><span class=o>;</span> <span class=n>i</span><span class=o>++)</span> <span class=o>{</span>  
</span></span><span class=line><span class=cl>      
</span></span><span class=line><span class=cl><span class=o>}</span>  
</span></span><span class=line><span class=cl><span class=n>endTime</span> <span class=o>=</span> <span class=n>System</span><span class=o>.</span><span class=na>nanoTime</span><span class=o>();</span>  
</span></span><span class=line><span class=cl><span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;优化list耗时：&#34;</span><span class=o>+(</span><span class=n>endTime</span> <span class=o>-</span> <span class=n>stratTime</span><span class=o>));</span>
</span></span></code></pre></td></tr></table></div></div><p><a href=https://segmentfault.com/a/1190000012688298 target=_blank rel="noopener noreffer">java性能优化笔记 —— for循环</a></p><h3 id=java-的取模运算>Java 的取模运算</h3><p>常用的取模运算符号为 %，比如 x % y，但该取模的结果正负与 x 相同，若 x 为负，则结果也为负。如果要与 y 保持相同符号，则应该使用 <code>Math.floorMod</code> 方法</p><h3 id=java-超-int>java 超 int</h3><p>超 int 结果时，会将高位截断，如果需要取模时，需要在强制类型转换前进行取模运算，否则结果运算错误。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kt>long</span> <span class=n>a</span> <span class=o>=</span> <span class=n>Long</span><span class=o>.</span><span class=na>MAX_VALUE</span><span class=o>:</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>ans</span> <span class=o>=</span> <span class=o>(</span><span class=kt>int</span><span class=o>)</span> <span class=o>(</span><span class=n>a</span> <span class=o>%</span> <span class=n>mod</span><span class=o>);</span>
</span></span></code></pre></td></tr></table></div></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2023-02-03</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/posts/java-%E5%9F%BA%E7%A1%80.html/index.md target=_blank>阅读原始文档</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 Twitter" data-sharer=twitter data-url=https://luckyouo.github.io/posts/java-%E5%9F%BA%E7%A1%80.html/ data-title="Java 基础" data-via=xxxx data-hashtags=java><i class="fab fa-twitter fa-fw"></i></a><a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://luckyouo.github.io/posts/java-%E5%9F%BA%E7%A1%80.html/ data-hashtag=java><i class="fab fa-facebook-square fa-fw"></i></a><a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://luckyouo.github.io/posts/java-%E5%9F%BA%E7%A1%80.html/ data-title="Java 基础"><i class="fab fa-weibo fa-fw"></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/java/>java</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/manacher-%E7%AE%97%E6%B3%95.html/ class=prev rel=prev title="Manacher 算法"><i class="fas fa-angle-left fa-fw"></i>Manacher 算法</a>
<a href=/posts/%E5%8F%8C%E6%8C%87%E9%92%88.html/ class=next rel=next title=双指针>双指针<i class="fas fa-angle-right fa-fw"></i></a></div></div><div id=comments></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><span id=run-time></span></div><div class=footer-line>由 <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.110.0">Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2022 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>luckyouo</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw"></i></a></div><div class=sidebar_wo><div id=leimu><img src=https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/b2t/leimuA.png alt=雷姆 onmouseover='this.src="https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/b2t/leimuB.png"' onmouseout='this.src="https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/b2t/leimuA.png"' title=回到顶部></div><div class=sidebar_wo id=lamu><img src=https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/b2t/lamuA.png alt=雷姆 onmouseover='this.src="https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/b2t/lamuB.png"' onmouseout='this.src="https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/b2t/lamuA.png"' title=回到底部></div></div><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=stylesheet href=/lib/katex/copy-tex.min.css><link rel=stylesheet href=/lib/cookieconsent/cookieconsent.min.css><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lunr/lunr.stemmer.support.min.js></script><script type=text/javascript src=/lib/lunr/lunr.zh.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js></script><script type=text/javascript src=/lib/katex/auto-render.min.js></script><script type=text/javascript src=/lib/katex/copy-tex.min.js></script><script type=text/javascript src=/lib/katex/mhchem.min.js></script><script type=text/javascript src=/lib/cookieconsent/cookieconsent.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:15},comment:{},cookieconsent:{content:{dismiss:"同意",link:"了解更多",message:"本网站使用 Cookies 来改善您的浏览体验."},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",lunrLanguageCode:"zh",lunrSegmentitURL:"/lib/lunr/lunr.segmentit.js",maxResultLength:10,noResultsFound:"没有找到结果",snippetLength:50,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/jquery@2.1.3/dist/jquery.min.js></script><script type=text/javascript src=/js/custom.js></script></body></html>