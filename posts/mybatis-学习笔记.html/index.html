<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>Mybatis 学习笔记 - Luckyouo Blog</title><meta name=Description content="Luckyouo 的小窝"><meta property="og:title" content="Mybatis 学习笔记"><meta property="og:description" content="前言 MyBatis 是一款优秀的持久层框架**，它支持定制化 SQL（灵活的修改）、存储过程（函数）以及高级**映射（javabean和数据库对象的映射-&"><meta property="og:type" content="article"><meta property="og:url" content="https://luckyouo.github.io/posts/mybatis-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html/"><meta property="og:image" content="https://luckyouo.github.io/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-04-11T16:50:49+08:00"><meta property="article:modified_time" content="2022-04-17T19:52:11+08:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://luckyouo.github.io/logo.png"><meta name=twitter:title content="Mybatis 学习笔记"><meta name=twitter:description content="前言 MyBatis 是一款优秀的持久层框架**，它支持定制化 SQL（灵活的修改）、存储过程（函数）以及高级**映射（javabean和数据库对象的映射-&"><meta name=application-name content="LoveIt"><meta name=apple-mobile-web-app-title content="LoveIt"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://luckyouo.github.io/posts/mybatis-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html/><link rel=prev href=https://luckyouo.github.io/posts/freemarker-%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95.html/><link rel=next href=https://luckyouo.github.io/posts/log4j-%E6%97%A5%E5%BF%97%E9%85%8D%E7%BD%AE.html/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Mybatis 学习笔记","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/luckyouo.github.io\/posts\/mybatis-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html\/"},"genre":"posts","keywords":"Mybatis","wordcount":3937,"url":"https:\/\/luckyouo.github.io\/posts\/mybatis-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html\/","datePublished":"2022-04-11T16:50:49+08:00","dateModified":"2022-04-17T19:52:11+08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"luckyouo"},"description":""}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><a href=https://github.com/luckyouo class=github-corner target=_blank title="Follow me on GitHub" aria-label="Follow me on GitHub"><svg width="3.5rem" height="3.5rem" viewBox="0 0 250 250" style="fill:#70b7fd;color:#fff;position:absolute;top:0;border:0;left:0;transform:scale(-1,1)" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><div class=header-title><a href=/ title="Luckyouo Blog">Luckyouo Blogs</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>归档 </a><a class=menu-item href=/tags/>标签 </a><a class=menu-item href=/categories/>分类 </a><a class=menu-item href=/friends/><i class="fas fa-fw fa-fan fa-spin"></i> 友链 </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder=搜索文章标题或内容... id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Luckyouo Blog">Luckyouo Blogs</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容... id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></div><a class=menu-item href=/posts/ title>归档</a><a class=menu-item href=/tags/ title>标签</a><a class=menu-item href=/categories/ title>分类</a><a class=menu-item href=/friends/ title><i class="fas fa-fw fa-fan fa-spin"></i>友链</a><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class="toc-content always-active" id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">Mybatis 学习笔记</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>luckyouo</a></span>&nbsp;<span class=post-category>收录于 <a href=/categories/spring/><i class="far fa-folder fa-fw"></i>Spring</a></span></div><div class=post-meta-line><i class="far fa-calendar fa-fw"></i>&nbsp;<time datetime=2022-04-11>2022-04-11</time>&nbsp;<i class="far fa-calendar-plus fa-fw"></i>&nbsp;<time datetime=2022-04-17>2022-04-17</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 3937 字&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 8 分钟&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ol><li><a href=#前言>前言</a></li><li><a href=#使用流程>使用流程</a><ol><li><a href=#导包>导包</a></li><li><a href=#配置数据库连接>配置数据库连接</a></li><li><a href=#生成-sqlsession--对象>生成 sqlSession 对象</a></li><li><a href=#配置查询语句>配置查询语句</a></li></ol></li><li><a href=#映射关系>映射关系</a><ol><li><a href=#输入映射>输入映射</a></li><li><a href=#输出映射>输出映射</a></li></ol></li><li><a href=#动态-sql-标签>动态 sql 标签</a><ol><li><a href=#where-标签><code>where</code> 标签</a></li><li><a href=#if-标签><code>if</code> 标签。</a></li><li><a href=#sql-标签><code>sql</code> 标签。</a></li><li><a href=#foreach-标签><code>foreach</code> 标签。</a></li></ol></li><li><a href=#mybatis-的优化>Mybatis 的优化</a><ol><li><a href=#懒加载>懒加载</a></li><li><a href=#缓存>缓存</a><ol><li><a href=#一级缓存>一级缓存</a></li><li><a href=#二级缓存>二级缓存</a></li></ol></li></ol></li><li><a href=#逆向工程>逆向工程</a><ol><li><a href=#导包-1>导包</a></li><li><a href=#配置文件设置>配置文件设置</a></li><li><a href=#引入逆向工程的-main-方法>引入逆向工程的 main 方法</a></li></ol></li><li><a href=#其他>其他</a></li></ol></nav></div></div><div class=content id=content><h2 id=前言>前言</h2><p>MyBatis 是一款优秀的<strong>持久层</strong>框架**，它支持<strong>定制化 SQL</strong>（灵活的修改）<strong>、<strong>存储过程</strong>（函数）以及</strong>高级**映射（javabean和数据库对象的映射->输入映射和输出映射）。MyBatis 避免了几乎所有的 <strong>JDBC</strong> 代码和手动设置参数以及获取结果集。</p><p>MyBatis 可以使用简单的 XML 或注解来配置和映射原生信息，将接口和 Java 的 <code>POJO</code> 映射成数据库中的记录。（ORM和持久化）</p><figure><img src=/images/mybatis.png><figcaption><h4>mybatis 流程图</h4></figcaption></figure><h2 id=使用流程>使用流程</h2><h3 id=导包>导包</h3><p>导入 <code>mybatis</code> 和 <code>mysql</code> 的依赖。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;groupId&gt;</span>org.mybatis<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;artifactId&gt;</span>mybatis<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;version&gt;</span>3.4.6<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/dependency&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;groupId&gt;</span>mysql<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;artifactId&gt;</span>mysql-connector-java<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;version&gt;</span>8.0.12<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;scope&gt;</span>runtime<span class=nt>&lt;/scope&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/dependency&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=配置数据库连接>配置数据库连接</h3><p>在 <code>mybatis.xml</code> 配置配置数据库的参数设置连接。主要配置内容为数据库驱动jdbc <code>driver</code> 、 数据库的连接信息和查询映射文件。</p><p>映射文件配置有两种方式：</p><ul><li>配置 <code>mapper</code> 标签处对应的为 <code>Mapper</code> 配置文件所在的位置<code>rsource</code> 。<strong>（配置文件需要与对应的映射接口处于同一个包下）</strong> ，如果没有配置，则后续 <code>sql</code> 语句第一个参数为 <code>全类名.sql方法</code> ， 书写较为复杂。</li><li>在 <code>mapper</code> 标签内配置 <code>package</code> 参数，该参数表示配置文件所在的包目录。（主要使用）</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
</span></span><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE configuration
</span></span></span><span class=line><span class=cl><span class=cp>        PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span></span></span><span class=line><span class=cl><span class=cp>        &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;configuration&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;environments</span> <span class=na>default=</span><span class=s>&#34;development&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;environment</span> <span class=na>id=</span><span class=s>&#34;development&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=c>&lt;!--Managed--&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;transactionManager</span> <span class=na>type=</span><span class=s>&#34;JDBC&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>            <span class=c>&lt;!--UNPooled--&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;dataSource</span> <span class=na>type=</span><span class=s>&#34;POOLED&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;driver&#34;</span> <span class=na>value=</span><span class=s>&#34;com.mysql.cj.jdbc.Driver&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;url&#34;</span> <span class=na>value=</span><span class=s>&#34;jdbc:mysql://localhost:3306/j13_jdbc_template?serverTimezone=GMT&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;username&#34;</span> <span class=na>value=</span><span class=s>&#34;root&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;password&#34;</span> <span class=na>value=</span><span class=s>&#34;admin&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;/dataSource&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/environment&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/environments&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;mappers&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;mapper</span> <span class=na>resource=</span><span class=s>&#34;com/cskaoyan/dao/UserDao.xml&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=c>&lt;!--&lt;package name=&#34;com.cskaoyan.dao&#34;/&gt;--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/mappers&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=生成-sqlsession--对象>生成 sqlSession 对象</h3><p>使用 <code>构建者</code> 模式生成 <code>sqlSession</code> 对象。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>MainTest</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>SqlSessionFactory</span> <span class=n>sqlSessionFactory</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>SqlSession</span> <span class=n>sqlSession</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Before</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>init</span><span class=o>()</span> <span class=kd>throws</span> <span class=n>IOException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>InputStream</span> <span class=n>inputStream</span> <span class=o>=</span> <span class=n>Resources</span><span class=o>.</span><span class=na>getResourceAsStream</span><span class=o>(</span><span class=s>&#34;mybatis.xml&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=c1>//通过建造者创建工厂
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>sqlSessionFactory</span> <span class=o>=</span> <span class=k>new</span> <span class=n>SqlSessionFactoryBuilder</span><span class=o>().</span><span class=na>build</span><span class=o>(</span><span class=n>inputStream</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@After</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>after</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>        <span class=n>sqlSession</span><span class=o>.</span><span class=na>commit</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>sqlSession</span><span class=o>.</span><span class=na>close</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Test</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>mytest</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>        <span class=n>sqlSession</span> <span class=o>=</span> <span class=n>sqlSessionFactory</span><span class=o>.</span><span class=na>openSession</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>UserMapper</span> <span class=n>mapper</span> <span class=o>=</span> <span class=n>sqlSession</span><span class=o>.</span><span class=na>getMapper</span><span class=o>(</span><span class=n>UserMapper</span><span class=o>.</span><span class=na>class</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>User</span> <span class=n>user</span> <span class=o>=</span> <span class=n>mapper</span><span class=o>.</span><span class=na>queryUserByid</span><span class=o>(</span><span class=n>1</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>user</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=配置查询语句>配置查询语句</h3><p>在 <code>UserDao.xml</code> 配置文件中使用标签配置 <code>sql</code> 语句，同名的映射接口配置 <code>sql</code> 操作方法，该方法名为 <code>sql</code> 语句的 <code>id</code> 。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;mapper</span> <span class=na>namespace=</span><span class=s>&#34;com.cskaoyan.mapper.UserMapper&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;insert</span> <span class=na>id=</span><span class=s>&#34;insertUser&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>        insert into j13_user_t (id, username, password, email) values (#{id}, #{username}, #{password}, #{email})
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/insert&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;delete</span> <span class=na>id=</span><span class=s>&#34;deleteUser&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>        delete from j13_user_t where id = #{id}
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/delete&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;update</span> <span class=na>id=</span><span class=s>&#34;updateUser&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>        update j13_user_t set username = #{username} where id = #{id}
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/update&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/mapper&gt;</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>interface</span> <span class=nc>UserMapper</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>User</span> <span class=nf>queryUserByid</span><span class=o>(</span><span class=kt>int</span> <span class=n>id</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=nf>insertUser</span><span class=o>(</span><span class=n>User</span> <span class=n>user</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=nf>deleteUser</span><span class=o>(</span><span class=kt>int</span> <span class=n>id</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=nf>updateUser</span><span class=o>(</span><span class=n>User</span> <span class=n>user</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p><code>insert</code> 操作的必须配置 <code>resultType（或者 resultMap）</code> ，其他 <code>sql</code> 操作没有该参数选项。</p><p><code>sql</code> 语句中传入的参数如果为基本类型时，则任意写，如果为 <code>javabean</code> 类型，则使用 <code>#{类.属性}</code> 进行选择。可以在调用 <code>sql</code> 语句中，使用注解 <code>@Param</code> 来限制后续选择，比如</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kt>int</span> <span class=nf>deleteUser</span><span class=o>(</span><span class=nd>@Param</span><span class=o>(</span><span class=s>&#34;id&#34;</span><span class=o>)</span><span class=kt>int</span> <span class=n>id</span><span class=o>);</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=映射关系>映射关系</h2><h3 id=输入映射>输入映射</h3><p>则在配置文件书写 <code>sql</code> 语句时，必须使用 <code>#{id}</code> 来访问传入参数 <code>id</code> 。</p><ol><li>简单类型。对应简单基本类型来说，如果没有配置注解 <code>@Param</code> ，则使用名称小写即可（内部以实现映射）。使用了注解，则根据注解使用。</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;update</span> <span class=na>id=</span><span class=s>&#34;updateUser&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    update j13_user_t set username = #{username} where id = #{id}
</span></span><span class=line><span class=cl><span class=nt>&lt;/update&gt;</span>
</span></span></code></pre></td></tr></table></div></div><ol start=2><li><code>POJO</code> ：没有使用注解时，使用类的小写即可（其中配置文件必须与类在同一个包下）。使用注解时，根据注解使用。如果传入类型为多个 <code>pojo</code> 类型时，且没有使用注解时，则使用 <code>param1</code> 、<code>param2</code> 来选择参数。使用了注解后，则使用注解对应的名字。（使用注解更加清晰），后续使用 <code>.</code> 来访问类内的属性。</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;update</span> <span class=na>id=</span><span class=s>&#34;updateUser&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    update j13_user_t set username = #{username} where id = #{param1.id}
</span></span><span class=line><span class=cl><span class=nt>&lt;/update&gt;</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;update</span> <span class=na>id=</span><span class=s>&#34;updateUser&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    update j13_user_t set username = #{username} where id = #{user.id}
</span></span><span class=line><span class=cl><span class=nt>&lt;/update&gt;</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li><code>Map</code> ：若只有一个传入参数，直接使用 <code>Key</code> 获取 <code>Value</code> 。若存在多个传入参数，则使用 <code>param1</code> 、<code>param2</code> 来选择。使用注解后根据注解使用。</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;update</span> <span class=na>id=</span><span class=s>&#34;updateUser&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    update j13_user_t set username = #{username} where id = #{param1.key}
</span></span><span class=line><span class=cl><span class=nt>&lt;/update&gt;</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;update</span> <span class=na>id=</span><span class=s>&#34;updateUser&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    update j13_user_t set username = #{username} where id = #{map.key}
</span></span><span class=line><span class=cl><span class=nt>&lt;/update&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>凡是使用了注解 <code>@Param</code> ，都根据注解进行匹配，尽量使用注解，使用注解可以提高代码可读性。</strong></p><p><strong>使用$符号访问参数时，有注入风险，使用#则mybatis会帮我们进行参数预处理</strong></p><h3 id=输出映射>输出映射</h3><ol><li>简单类型。查询列必须为单列，才能使用简单类型映射</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;select</span> <span class=na>id=</span><span class=s>&#34;selectUser&#34;</span> <span class=na>resultType=</span><span class=s>&#34;string&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    select id from j13_user_t where username = #{user.username}
</span></span><span class=line><span class=cl><span class=nt>&lt;/update&gt;</span>
</span></span></code></pre></td></tr></table></div></div><ol start=2><li><code>pojo</code> 对象映射。在 <code>ResultType</code> 字段配置 <code>pojo</code> 对象（因为映射接口和配置文件在同一包下，直接使用类小写即可），且查询列名必须与映射的类的属性名一一对应才能映射成功，如果某属性映射不成功，则设置为null。<code>resultType</code> 为类名的小写（配置文件必须与类在一个包内）。</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>User</span><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>id</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>username</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>password</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>email</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;select</span> <span class=na>id=</span><span class=s>&#34;selectUser&#34;</span> <span class=na>resultType=</span><span class=s>&#34;user&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    select id,username,password,email from j13_user_t where username = #{user.username}
</span></span><span class=line><span class=cl><span class=nt>&lt;/update&gt;</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li><code>ResultMap</code> 对象映射。查询的列名不再需要与对象的属性名一一对应，但是需要通过 <code>ResultMap</code> 标签来设置列名和属性名进行映射，其中 <code>column</code> 设置查询的结果的列名，<code>property</code> 设置属性名。</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;resultMap</span> <span class=na>id=</span><span class=s>&#34;userMap&#34;</span> <span class=na>type=</span><span class=s>&#34;user&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;result</span> <span class=na>column=</span><span class=s>&#34;id&#34;</span> <span class=na>property=</span><span class=s>&#34;idz&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;result</span> <span class=na>column=</span><span class=s>&#34;username&#34;</span> <span class=na>property=</span><span class=s>&#34;usernames&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;result</span> <span class=na>column=</span><span class=s>&#34;password&#34;</span> <span class=na>property=</span><span class=s>&#34;passwordw&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;result</span> <span class=na>column=</span><span class=s>&#34;email&#34;</span> <span class=na>property=</span><span class=s>&#34;emaill&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/resultMap&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;select</span> <span class=na>id=</span><span class=s>&#34;queryUserById&#34;</span> <span class=na>resultMap=</span><span class=s>&#34;userMap&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    select id,username,password,email from j13_user_t where id=#{id}
</span></span><span class=line><span class=cl><span class=nt>&lt;/select&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>上述类中的属性名分别为 <code>idz</code> 、<code>usernames</code> 、<code>passwordw</code> 和 <code>emaill</code> ，将查询结果与对应属性映射起来。</p><h2 id=动态-sql-标签>动态 sql 标签</h2><p>常用的标签有 <code>where</code> 、 <code>if</code> 、<code>sql</code> 和 <code>foreach</code> 。标签的主要作用是将 <code>sql</code> 语句分成若干段，可以使用 <code>inclde</code> 标签和 <code>refid</code> 属性引用 <code>sql</code> 语句段，从而代码重用，减少冗余代码。</p><h3 id=where-标签><code>where</code> 标签</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;select</span> <span class=na>id=</span><span class=s>&#34;selectUser&#34;</span> <span class=na>resultType=</span><span class=s>&#34;string&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    select id from j13_user_t 
</span></span><span class=line><span class=cl>    <span class=nt>&lt;where&gt;</span>
</span></span><span class=line><span class=cl>        username = #{user.username}
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/where&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/update&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=if-标签><code>if</code> 标签。</h3><p>需要注意的是除了第一个 <code>if</code> 标签，后续 <code>if</code> 标签都需要添加 <code>and</code> 或者 <code>or</code> ，来表示层次关系。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;select</span> <span class=na>id=</span><span class=s>&#34;selectUser&#34;</span> <span class=na>resultType=</span><span class=s>&#34;string&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    select id from j13_user_t 
</span></span><span class=line><span class=cl>    <span class=nt>&lt;where&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;if</span> <span class=na>test=</span><span class=s>&#34;username != null&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>        	username = #{username}
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/if&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;if</span> <span class=na>test=</span><span class=s>&#34;age != 0&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>        	and age = #{age}
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/if&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/where&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/update&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=sql-标签><code>sql</code> 标签。</h3><p>主要是用作片段，给其他语句 <code>include</code> 使用。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;sql</span> <span class=na>id=</span><span class=s>&#34;selectAll&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>	select id,username,password,email from j13_user_t
</span></span><span class=line><span class=cl><span class=nt>&lt;/sql&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=foreach-标签><code>foreach</code> 标签。</h3><p>用来遍历链表或者数组。</p><ul><li>未使用注解的数组。<code>collection</code> 使用 <code>array</code> , <code>item</code> 表示每次迭代的对象，<code>separator</code> 表示每次迭代后的连接符号，<code>index</code> 表示索引，从 <code>0</code> 开始。</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;insert</span> <span class=na>id=</span><span class=s>&#34;insertArray&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>	insert into j13_user_t (id,username,password,email) values
</span></span><span class=line><span class=cl>    <span class=nt>&lt;foreach</span> <span class=na>collection=</span><span class=s>&#34;array&#34;</span> <span class=na>item=</span><span class=s>&#34;user&#34;</span> <span class=na>sepatrtor=</span><span class=s>&#34;,&#34;</span> <span class=na>index=</span><span class=s>&#34;index&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    	(#{user.id}, #{user.username},#{user.password},#{user.email})
</span></span><span class=line><span class=cl>	<span class=nt>&lt;/foreach&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/insert&gt;</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>未使用注解的List。<code>collection</code> 使用 <code>list</code> 。<code>open</code> 和 <code>close</code> 表示迭代后的字符串左右两边的符号。若不使用的这两个属性，需要手动增加两个括号，代码不够优雅。</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;insert</span> <span class=na>id=</span><span class=s>&#34;selectUserById&#34;</span> <span class=na>resultType=</span><span class=s>&#34;user&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>	select id,username,password,email from j13_uset_t
</span></span><span class=line><span class=cl>    <span class=nt>&lt;where&gt;</span>
</span></span><span class=line><span class=cl>        id in 
</span></span><span class=line><span class=cl>        <span class=nt>&lt;foreach</span> <span class=na>collection=</span><span class=s>&#34;list&#34;</span> <span class=na>item=</span><span class=s>&#34;userid&#34;</span> <span class=na>open=</span><span class=s>&#34;(&#34;</span> <span class=err>close&#34;)&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    		#(userid)
</span></span><span class=line><span class=cl>		<span class=nt>&lt;/foreach&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/where&gt;</span>    
</span></span><span class=line><span class=cl><span class=nt>&lt;/insert&gt;</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>使用注解的数组和List。</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;insert</span> <span class=na>id=</span><span class=s>&#34;insertArray&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>	insert into j13_user_t (id,username,password,email) values
</span></span><span class=line><span class=cl>    <span class=nt>&lt;foreach</span> <span class=na>collection=</span><span class=s>&#34;users&#34;</span> <span class=na>item=</span><span class=s>&#34;user&#34;</span> <span class=na>sepatrtor=</span><span class=s>&#34;,&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    	(#{user.id}, #{user.username},#{user.password},#{user.email})
</span></span><span class=line><span class=cl>	<span class=nt>&lt;/foreach&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/insert&gt;</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;insert</span> <span class=na>id=</span><span class=s>&#34;selectUserById&#34;</span> <span class=na>resultType=</span><span class=s>&#34;user&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>	select id,username,password,email from j13_uset_t
</span></span><span class=line><span class=cl>    <span class=nt>&lt;where&gt;</span>
</span></span><span class=line><span class=cl>        id in 
</span></span><span class=line><span class=cl>        <span class=nt>&lt;foreach</span> <span class=na>collection=</span><span class=s>&#34;ids&#34;</span> <span class=na>item=</span><span class=s>&#34;id&#34;</span> <span class=na>open=</span><span class=s>&#34;(&#34;</span> <span class=err>close&#34;)&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    		#(id)
</span></span><span class=line><span class=cl>		<span class=nt>&lt;/foreach&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/where&gt;</span>    
</span></span><span class=line><span class=cl><span class=nt>&lt;/insert&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=mybatis-的优化>Mybatis 的优化</h2><h3 id=懒加载>懒加载</h3><p>根据数据的使用情况，按需加载 sql 语句。当某个 sql 语句执行完成后，没有书用到其中的数据时，则可以暂时不执行该语句。Mybatis 默认是没有懒加载的，需要在 Myabis 的 mybatis.xml 配置文件中手动开启，同时在映射文件中设置 <code>fetchType</code> 启用懒加载。（连接查询是没有懒加载的）</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-XML data-lang=XML><span class=line><span class=cl><span class=nt>&lt;configuration&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;settings&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;setting</span> <span class=na>name=</span><span class=s>&#34;lazyLoadingEnabled&#34;</span> <span class=na>value=</span><span class=s>&#34;true&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;setting</span> <span class=na>name=</span><span class=s>&#34;cacheEnabled&#34;</span> <span class=na>value=</span><span class=s>&#34;true&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/settings&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/configuration&gt;</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;resultMap</span> <span class=na>id=</span><span class=s>&#34;userMap&#34;</span> <span class=na>type=</span><span class=s>&#34;user&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;result</span> <span class=na>column=</span><span class=s>&#34;id&#34;</span> <span class=na>property=</span><span class=s>&#34;id&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;result</span> <span class=na>column=</span><span class=s>&#34;username&#34;</span> <span class=na>property=</span><span class=s>&#34;username&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;result</span> <span class=na>column=</span><span class=s>&#34;password&#34;</span> <span class=na>property=</span><span class=s>&#34;password&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;result</span> <span class=na>column=</span><span class=s>&#34;email&#34;</span> <span class=na>property=</span><span class=s>&#34;email&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--property是我们1的成员变量名--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--colume是来源于第一次查询结果的列名，并且为第二次查询提供参数--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;association</span> <span class=na>property=</span><span class=s>&#34;userDetail&#34;</span> <span class=na>fetchType=</span><span class=s>&#34;lazy&#34;</span> <span class=na>column=</span><span class=s>&#34;id&#34;</span> <span class=na>select=</span><span class=s>&#34;com.cskaoyan.mapper.UserDetailMapper.selectUserDetailByUid&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/resultMap&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=缓存>缓存</h3><p>为了减少磁盘的IO，mybatis 提供了缓存机制。</p><figure><img src=/images/mybatis_cache.png><figcaption><h4>mybatis 缓存</h4></figcaption></figure><h4 id=一级缓存>一级缓存</h4><p>一级缓存默认是开启的，一级缓存级别是 sqlSession 级别的，即不同的 sqlSession 不会共享缓存。当 sqlSession commit 提交之后，缓存失效。同时若数据库的数据发生更改、添加和删除时，则缓存失效。</p><h4 id=二级缓存>二级缓存</h4><p>二级缓存默认是关闭的，二级缓存级别是 mapper 级别的，<strong>当 sqlSession 提交之后，二级缓存才生成</strong> ，同时不同的 sqlSession 对象（同一个类的不同 sqlSession 对象）的 mapper 也共享当前缓存，如果对数据库进行了增删改操作是，<strong>如果没有提交事务，则缓存不会失效，即可能造成幻读</strong>，只有提交事务之后缓存才失效，需要注意。</p><p>二级缓存需要在 mybatis.xml 配置文件中开启</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;settings&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;setting</span> <span class=na>name=</span><span class=s>&#34;lazyLoadingEnabled&#34;</span> <span class=na>value=</span><span class=s>&#34;true&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;setting</span> <span class=na>name=</span><span class=s>&#34;cacheEnabled&#34;</span> <span class=na>value=</span><span class=s>&#34;true&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/settings&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>如果要对某一个类的进行二级缓存查询时，必须实现序列化接口，进行序列化，否则无法缓存，同时在该类的映射文件在添加 <code>cache</code> 标签。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>User</span> <span class=kd>implements</span> <span class=n>Serializable</span><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;cache/&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=逆向工程>逆向工程</h2><p>为了减少映射文件的书写，可以使用逆向工程生成映射文件。</p><h3 id=导包-1>导包</h3><p>导包逆向工程的依赖和数据库的依赖</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;groupId&gt;</span>org.mybatis.generator<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;artifactId&gt;</span>mybatis-generator-core<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;version&gt;</span>1.4.1<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/dependency&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;groupId&gt;</span>mysql<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;artifactId&gt;</span>mysql-connector-java<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;version&gt;</span>8.0.12<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;scope&gt;</span>runtime<span class=nt>&lt;/scope&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/dependency&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=配置文件设置>配置文件设置</h3><p>在项目的根目录下配置逆向工程的配置 <code>generatorConfig.xml</code> 。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl><span class=cp>&lt;!DOCTYPE generatorConfiguration
</span></span></span><span class=line><span class=cl><span class=cp>        PUBLIC &#34;-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN&#34;
</span></span></span><span class=line><span class=cl><span class=cp>        &#34;http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd&#34;&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;generatorConfiguration&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;context</span> <span class=na>id=</span><span class=s>&#34;testTables&#34;</span> <span class=na>targetRuntime=</span><span class=s>&#34;MyBatis3&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;commentGenerator&gt;</span>
</span></span><span class=line><span class=cl>            <span class=c>&lt;!-- 是否去除自动生成的注释 true：是 ： false:否 --&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;suppressAllComments&#34;</span> <span class=na>value=</span><span class=s>&#34;true&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/commentGenerator&gt;</span>
</span></span><span class=line><span class=cl>        <span class=c>&lt;!--数据库连接的信息：驱动类、连接地址、用户名、密码 --&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;jdbcConnection</span> <span class=na>driverClass=</span><span class=s>&#34;com.mysql.cj.jdbc.Driver&#34;</span>
</span></span><span class=line><span class=cl>                        <span class=na>connectionURL=</span><span class=s>&#34;jdbc:mysql://localhost:3306/j13_jdbc_template?serverTimezone=GMT&#34;</span>
</span></span><span class=line><span class=cl>                        <span class=na>userId=</span><span class=s>&#34;root&#34;</span>
</span></span><span class=line><span class=cl>                        <span class=na>password=</span><span class=s>&#34;admin&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;nullCatalogMeansCurrent&#34;</span> <span class=na>value=</span><span class=s>&#34;true&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/jdbcConnection&gt;</span>
</span></span><span class=line><span class=cl>        <span class=c>&lt;!--&amp;lt;!&amp;ndash;
</span></span></span><span class=line><span class=cl><span class=c>            for oracle
</span></span></span><span class=line><span class=cl><span class=c>           &amp;ndash;&amp;gt;
</span></span></span><span class=line><span class=cl><span class=c>        &lt;jdbcConnection driverClass=&#34;oracle.jdbc.OracleDriver&#34;
</span></span></span><span class=line><span class=cl><span class=c>            connectionURL=&#34;jdbc:oracle:thin:@127.0.0.1:1521:yycg&#34;
</span></span></span><span class=line><span class=cl><span class=c>            userId=&#34;yycg&#34;
</span></span></span><span class=line><span class=cl><span class=c>            password=&#34;yycg&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=c>        &lt;/jdbcConnection&gt;--&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c>&lt;!-- 默认false，
</span></span></span><span class=line><span class=cl><span class=c>            为false把JDBC DECIMAL 和 NUMERIC 类型解析为Integer，
</span></span></span><span class=line><span class=cl><span class=c>            为 true把JDBC DECIMAL 和 NUMERIC 类型解析为java.math.BigDecimal --&gt;</span>
</span></span><span class=line><span class=cl>        <span class=c>&lt;!--&lt;javaTypeResolver&gt;
</span></span></span><span class=line><span class=cl><span class=c>            &lt;property name=&#34;forceBigDecimals&#34; value=&#34;false&#34; /&gt;
</span></span></span><span class=line><span class=cl><span class=c>        &lt;/javaTypeResolver&gt;--&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c>&lt;!-- javaModelGenerator javaBean生成的配置信息
</span></span></span><span class=line><span class=cl><span class=c>             targetProject:生成PO类的位置
</span></span></span><span class=line><span class=cl><span class=c>             targetPackage：生成PO类的类名--&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;javaModelGenerator</span> <span class=na>targetPackage=</span><span class=s>&#34;com.cskaoyan.bean&#34;</span>
</span></span><span class=line><span class=cl>                            <span class=na>targetProject=</span><span class=s>&#34;./mybatis_demo8/src/main/java&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=c>&lt;!-- enableSubPackages:是否允许子包,是否让schema作为包的后缀
</span></span></span><span class=line><span class=cl><span class=c>                 即targetPackage.schemaName.tableName --&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;enableSubPackages&#34;</span> <span class=na>value=</span><span class=s>&#34;true&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>            <span class=c>&lt;!-- 从数据库返回的值是否清理前后的空格 --&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;trimStrings&#34;</span> <span class=na>value=</span><span class=s>&#34;true&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/javaModelGenerator&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c>&lt;!-- sqlMapGenerator Mapper映射文件的配置信息
</span></span></span><span class=line><span class=cl><span class=c>            targetProject:mapper映射文件生成的位置
</span></span></span><span class=line><span class=cl><span class=c>            targetPackage:生成mapper映射文件放在哪个包下--&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;sqlMapGenerator</span> <span class=na>targetPackage=</span><span class=s>&#34;com.cskaoyan.mapper&#34;</span>
</span></span><span class=line><span class=cl>                         <span class=na>targetProject=</span><span class=s>&#34;./mybatis_demo8/src/main/resources&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=c>&lt;!-- enableSubPackages:是否让schema作为包的后缀 --&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;enableSubPackages&#34;</span> <span class=na>value=</span><span class=s>&#34;true&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/sqlMapGenerator&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c>&lt;!--
</span></span></span><span class=line><span class=cl><span class=c>           javaClientGenerator 生成 Model对象(JavaBean)和 mapper XML配置文件 对应的Dao代码
</span></span></span><span class=line><span class=cl><span class=c>           targetProject:mapper接口生成的位置
</span></span></span><span class=line><span class=cl><span class=c>           targetPackage:生成mapper接口放在哪个包下
</span></span></span><span class=line><span class=cl><span class=c>
</span></span></span><span class=line><span class=cl><span class=c>           ANNOTATEDMAPPER
</span></span></span><span class=line><span class=cl><span class=c>           XMLMAPPER
</span></span></span><span class=line><span class=cl><span class=c>           MIXEDMAPPER
</span></span></span><span class=line><span class=cl><span class=c>        --&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;javaClientGenerator</span> <span class=na>type=</span><span class=s>&#34;XMLMAPPER&#34;</span>
</span></span><span class=line><span class=cl>                             <span class=na>targetPackage=</span><span class=s>&#34;com.cskaoyan.mapper&#34;</span>
</span></span><span class=line><span class=cl>                             <span class=na>targetProject=</span><span class=s>&#34;./mybatis_demo8/src/main/java&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=c>&lt;!-- enableSubPackages:是否让schema作为包的后缀 --&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;enableSubPackages&#34;</span> <span class=na>value=</span><span class=s>&#34;true&#34;</span> <span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/javaClientGenerator&gt;</span><span class=c>&lt;!----&gt;</span>
</span></span><span class=line><span class=cl>        <span class=c>&lt;!-- 指定数据库表 --&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c>&lt;!-- 指定所有数据库表 --&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            <span class=c>&lt;!--&lt;table tableName=&#34;%&#34;
</span></span></span><span class=line><span class=cl><span class=c>                   enableCountByExample=&#34;false&#34;
</span></span></span><span class=line><span class=cl><span class=c>                   enableUpdateByExample=&#34;false&#34;
</span></span></span><span class=line><span class=cl><span class=c>                   enableDeleteByExample=&#34;false&#34;
</span></span></span><span class=line><span class=cl><span class=c>                   enableSelectByExample=&#34;false&#34;
</span></span></span><span class=line><span class=cl><span class=c>                   enableInsert=&#34;false&#34;
</span></span></span><span class=line><span class=cl><span class=c>                   enableDeleteByPrimaryKey=&#34;true&#34;
</span></span></span><span class=line><span class=cl><span class=c>                   enableSelectByPrimaryKey=&#34;true&#34;
</span></span></span><span class=line><span class=cl><span class=c>                   selectByExampleQueryId=&#34;false&#34; &gt;&lt;/table&gt;--&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>               <span class=c>&lt;!-- 指定数据库表，要生成哪些表，就写哪些表，要和数据库中对应，不能写错！ --&gt;</span>
</span></span><span class=line><span class=cl>               <span class=nt>&lt;table</span>  <span class=na>tableName=</span><span class=s>&#34;j13_user_t&#34;</span>
</span></span><span class=line><span class=cl>                       <span class=na>enableCountByExample=</span><span class=s>&#34;false&#34;</span>
</span></span><span class=line><span class=cl>                       <span class=na>enableUpdateByExample=</span><span class=s>&#34;false&#34;</span>
</span></span><span class=line><span class=cl>                       <span class=na>enableDeleteByExample=</span><span class=s>&#34;false&#34;</span>
</span></span><span class=line><span class=cl>                       <span class=na>enableSelectByExample=</span><span class=s>&#34;false&#34;</span>
</span></span><span class=line><span class=cl>                       <span class=na>enableInsert=</span><span class=s>&#34;true&#34;</span>
</span></span><span class=line><span class=cl>                       <span class=na>enableDeleteByPrimaryKey=</span><span class=s>&#34;true&#34;</span>
</span></span><span class=line><span class=cl>                       <span class=na>enableSelectByPrimaryKey=</span><span class=s>&#34;true&#34;</span>
</span></span><span class=line><span class=cl>                       <span class=na>selectByExampleQueryId=</span><span class=s>&#34;false&#34;</span>
</span></span><span class=line><span class=cl>                       <span class=na>domainObjectName=</span><span class=s>&#34;User&#34;</span>
</span></span><span class=line><span class=cl>               <span class=nt>&gt;</span> <span class=nt>&lt;/table&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;table</span> <span class=na>tableName=</span><span class=s>&#34;j13_student_t&#34;</span> <span class=na>domainObjectName=</span><span class=s>&#34;Student&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>                <span class=nt>&lt;table</span> <span class=na>tableName=</span><span class=s>&#34;j13_course_t&#34;</span> <span class=na>domainObjectName=</span><span class=s>&#34;Course&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c>&lt;!--      &lt;table schema=&#34;&#34; tableName=&#34;orders&#34;&gt;&lt;/table&gt;
</span></span></span><span class=line><span class=cl><span class=c>             &lt;table schema=&#34;&#34; tableName=&#34;items&#34;&gt;&lt;/table&gt;
</span></span></span><span class=line><span class=cl><span class=c>             &lt;table schema=&#34;&#34; tableName=&#34;orderdetail&#34;&gt;&lt;/table&gt;
</span></span></span><span class=line><span class=cl><span class=c>      --&gt;</span>
</span></span><span class=line><span class=cl>               <span class=c>&lt;!-- 有些表的字段需要指定java类型
</span></span></span><span class=line><span class=cl><span class=c>                &lt;table schema=&#34;&#34; tableName=&#34;&#34;&gt;
</span></span></span><span class=line><span class=cl><span class=c>                   &lt;columnOverride column=&#34;&#34; javaType=&#34;&#34; /&gt;
</span></span></span><span class=line><span class=cl><span class=c>               &lt;/table&gt; --&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/context&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/generatorConfiguration&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=引入逆向工程的-main-方法>引入逆向工程的 main 方法</h3><p>配置 main 方法，并运行，即可以生成配置文件中设置好的映射配置文件。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Generator</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kt>void</span> <span class=nf>generator</span><span class=o>()</span> <span class=kd>throws</span> <span class=n>Exception</span><span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>List</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>warnings</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ArrayList</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;();</span>
</span></span><span class=line><span class=cl>        <span class=kt>boolean</span> <span class=n>overwrite</span> <span class=o>=</span> <span class=kc>true</span><span class=o>;</span> <span class=c1>//指向逆向工程配置文件
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>File</span> <span class=n>configFile</span> <span class=o>=</span> <span class=k>new</span> <span class=n>File</span><span class=o>(</span><span class=s>&#34;mybatis/generatorConfig.xml&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>configFile</span><span class=o>.</span><span class=na>getAbsolutePath</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=n>ConfigurationParser</span> <span class=n>cp</span> <span class=o>=</span> <span class=k>new</span> <span class=n>ConfigurationParser</span><span class=o>(</span><span class=n>warnings</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Configuration</span> <span class=n>config</span> <span class=o>=</span> <span class=n>cp</span><span class=o>.</span><span class=na>parseConfiguration</span><span class=o>(</span><span class=n>configFile</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>DefaultShellCallback</span> <span class=n>callback</span> <span class=o>=</span> <span class=k>new</span> <span class=n>DefaultShellCallback</span><span class=o>(</span><span class=n>overwrite</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>MyBatisGenerator</span> <span class=n>myBatisGenerator</span> <span class=o>=</span>
</span></span><span class=line><span class=cl>                <span class=k>new</span> <span class=n>MyBatisGenerator</span><span class=o>(</span><span class=n>config</span><span class=o>,</span> <span class=n>callback</span><span class=o>,</span> <span class=n>warnings</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>myBatisGenerator</span><span class=o>.</span><span class=na>generate</span><span class=o>(</span><span class=kc>null</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Exception</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>Generator</span> <span class=n>generatorSqlmap</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Generator</span><span class=o>();</span>
</span></span><span class=line><span class=cl>            <span class=n>generatorSqlmap</span><span class=o>.</span><span class=na>generator</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=k>catch</span> <span class=o>(</span><span class=n>Exception</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>e</span><span class=o>.</span><span class=na>printStackTrace</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=其他>其他</h2><ol><li>若映射文件和映射类在同一个包下，且名字相同时，则在映射文件中 resultType 通常用类名小写来代表返回类型。也可以在类名上使用 <code>@Alias</code> 注解，来规定返回使用类型别名。</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Alias</span><span class=o>(</span><span class=s>&#34;fruit&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>Apple</span><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=o>...</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;select</span> <span class=na>id=</span><span class=s>&#34;selectApple&#34;</span> <span class=na>resultType=</span><span class=s>&#34;fruit&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>	select * from j13_apple_t
</span></span><span class=line><span class=cl><span class=nt>&lt;/select&gt;</span>
</span></span></code></pre></td></tr></table></div></div><ol start=2><li>对于简单的 sql 语句时，可以直接在映射接口上使用注解来完成</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>interface</span> <span class=nc>AppleManager</span><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Select</span><span class=o>(</span><span class=s>&#34;select * from j13_apple_t where id #{id}&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl>    <span class=n>Apple</span> <span class=nf>selectAppleById</span><span class=o>(</span><span class=nd>@Param</span><span class=o>(</span><span class=s>&#34;id&#34;</span><span class=o>)</span> <span class=kt>int</span> <span class=n>id</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2022-04-17</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/posts/mybatis-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html/index.md target=_blank>阅读原始文档</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 Twitter" data-sharer=twitter data-url=https://luckyouo.github.io/posts/mybatis-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html/ data-title="Mybatis 学习笔记" data-via=xxxx data-hashtags=Mybatis><i class="fab fa-twitter fa-fw"></i></a><a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://luckyouo.github.io/posts/mybatis-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html/ data-hashtag=Mybatis><i class="fab fa-facebook-square fa-fw"></i></a><a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://luckyouo.github.io/posts/mybatis-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html/ data-title="Mybatis 学习笔记"><i class="fab fa-weibo fa-fw"></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/mybatis/>Mybatis</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/freemarker-%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95.html/ class=prev rel=prev title="Freemarker 学习记录"><i class="fas fa-angle-left fa-fw"></i>Freemarker 学习记录</a>
<a href=/posts/log4j-%E6%97%A5%E5%BF%97%E9%85%8D%E7%BD%AE.html/ class=next rel=next title="log4j 日志配置">log4j 日志配置<i class="fas fa-angle-right fa-fw"></i></a></div></div><div id=comments></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><span id=run-time></span></div><div class=footer-line>由 <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.97.1">Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>luckyouo</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw"></i></a></div><div class=sidebar_wo><div id=leimu><img src=https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/b2t/leimuA.png alt=雷姆 onmouseover='this.src="https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/b2t/leimuB.png"' onmouseout='this.src="https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/b2t/leimuA.png"' title=回到顶部></div><div class=sidebar_wo id=lamu><img src=https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/b2t/lamuA.png alt=雷姆 onmouseover='this.src="https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/b2t/lamuB.png"' onmouseout='this.src="https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/b2t/lamuA.png"' title=回到底部></div></div><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=stylesheet href=/lib/katex/copy-tex.min.css><link rel=stylesheet href=/lib/cookieconsent/cookieconsent.min.css><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lunr/lunr.stemmer.support.min.js></script><script type=text/javascript src=/lib/lunr/lunr.zh.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js></script><script type=text/javascript src=/lib/katex/auto-render.min.js></script><script type=text/javascript src=/lib/katex/copy-tex.min.js></script><script type=text/javascript src=/lib/katex/mhchem.min.js></script><script type=text/javascript src=/lib/cookieconsent/cookieconsent.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:15},comment:{},cookieconsent:{content:{dismiss:"同意",link:"了解更多",message:"本网站使用 Cookies 来改善您的浏览体验."},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",lunrLanguageCode:"zh",lunrSegmentitURL:"/lib/lunr/lunr.segmentit.js",maxResultLength:10,noResultsFound:"没有找到结果",snippetLength:50,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/jquery@2.1.3/dist/jquery.min.js></script><script type=text/javascript src=/js/custom.js></script></body></html>