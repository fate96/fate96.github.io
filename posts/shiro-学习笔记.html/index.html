<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>Shiro 学习笔记 - Luckyouo Blog</title><meta name=Description content="Luckyouo 的小窝"><meta property="og:title" content="Shiro 学习笔记"><meta property="og:description" content="前言 当用户访问网站时，需要判断用户用户是否登陆以及权限问题，这时需要对用户进行认证和授权。Spring 框架提供了 spring security 权限框架，但是与 spring 过于耦"><meta property="og:type" content="article"><meta property="og:url" content="https://luckyouo.github.io/posts/shiro-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html/"><meta property="og:image" content="https://luckyouo.github.io/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-04-20T15:24:58+08:00"><meta property="article:modified_time" content="2022-04-20T17:08:08+08:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://luckyouo.github.io/logo.png"><meta name=twitter:title content="Shiro 学习笔记"><meta name=twitter:description content="前言 当用户访问网站时，需要判断用户用户是否登陆以及权限问题，这时需要对用户进行认证和授权。Spring 框架提供了 spring security 权限框架，但是与 spring 过于耦"><meta name=application-name content="LoveIt"><meta name=apple-mobile-web-app-title content="LoveIt"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://luckyouo.github.io/posts/shiro-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html/><link rel=prev href=https://luckyouo.github.io/posts/python-%E7%B1%BB%E6%A8%A1%E5%9D%97%E5%92%8C%E5%8C%85.html/><link rel=next href=https://luckyouo.github.io/posts/dataset-sampler-%E5%92%8C-dataloader-%E4%B8%89%E8%80%85%E7%9A%84%E5%85%B3%E7%B3%BB.html/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Shiro 学习笔记","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/luckyouo.github.io\/posts\/shiro-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html\/"},"genre":"posts","keywords":"shiro","wordcount":2163,"url":"https:\/\/luckyouo.github.io\/posts\/shiro-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html\/","datePublished":"2022-04-20T15:24:58+08:00","dateModified":"2022-04-20T17:08:08+08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"luckyouo"},"description":""}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><a href=https://github.com/luckyouo class=github-corner target=_blank title="Follow me on GitHub" aria-label="Follow me on GitHub"><svg width="3.5rem" height="3.5rem" viewBox="0 0 250 250" style="fill:#70b7fd;color:#fff;position:absolute;top:0;border:0;left:0;transform:scale(-1,1)" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><div class=header-title><a href=/ title="Luckyouo Blog">Luckyouo Blogs</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>归档 </a><a class=menu-item href=/tags/>标签 </a><a class=menu-item href=/categories/>分类 </a><a class=menu-item href=/friends/><i class='fas fa-fw fa-fan fa-spin'></i> 友链 </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder=搜索文章标题或内容... id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Luckyouo Blog">Luckyouo Blogs</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容... id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></div><a class=menu-item href=/posts/ title>归档</a><a class=menu-item href=/tags/ title>标签</a><a class=menu-item href=/categories/ title>分类</a><a class=menu-item href=/friends/ title><i class='fas fa-fw fa-fan fa-spin'></i>友链</a><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class="toc-content always-active" id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">Shiro 学习笔记</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>luckyouo</a></span>&nbsp;<span class=post-category>收录于 <a href=/categories/spring/><i class="far fa-folder fa-fw"></i>Spring</a></span></div><div class=post-meta-line><i class="far fa-calendar fa-fw"></i>&nbsp;<time datetime=2022-04-20>2022-04-20</time>&nbsp;<i class="far fa-calendar-plus fa-fw"></i>&nbsp;<time datetime=2022-04-20>2022-04-20</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 2163 字&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 5 分钟&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ol><li><a href=#前言>前言</a></li><li><a href=#使用流程>使用流程</a><ol><li><a href=#导入依赖>导入依赖</a></li><li><a href=#securitymanager-配置>SecurityManager 配置</a><ol><li><a href=#使用配置文件初始化了解>使用配置文件初始化（了解）</a></li><li><a href=#使用配置类时>使用配置类时</a></li></ol></li><li><a href=#获取-subject-对象>获取 Subject 对象</a></li><li><a href=#自定义-realm>自定义 Realm</a><ol><li><a href=#使用配置文件了解>使用配置文件（了解）</a></li><li><a href=#使用配置类>使用配置类</a></li></ol></li><li><a href=#配置filter>配置Filter</a><ol><li><a href=#使用配置文件>使用配置文件</a></li><li><a href=#使用配置类-1>使用配置类</a></li></ol></li></ol></li><li><a href=#其他>其他</a></li></ol></nav></div></div><div class=content id=content><h2 id=前言>前言</h2><p>当用户访问网站时，需要判断用户用户是否登陆以及权限问题，这时需要对用户进行认证和授权。Spring 框架提供了 <code>spring security</code> 权限框架，但是与 spring 过于耦合，而 shiro 是 apache 的一个开源框架，是一个权限管理的框架，实现 用户认证、用户授权.</p><figure><img src=/images/shiro.png><figcaption><h4>shiro 工作流程</h4></figcaption></figure><h2 id=使用流程>使用流程</h2><h3 id=导入依赖>导入依赖</h3><p><code>shiro-spring</code> 提供了与 spring 整合的依赖，同时还附带了 shiro 的三个依赖。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;groupId&gt;</span>org.apache.shiro<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;artifactId&gt;</span>shiro-spring<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;version&gt;</span>1.2.3<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/dependency&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;groupId&gt;</span>org.slf4j<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;artifactId&gt;</span>slf4j-log4j12<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;version&gt;</span>1.7.25<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/dependency&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=securitymanager-配置>SecurityManager 配置</h3><p>SecurityManager 是 shiro 核心模块，需要对其进行初始化。</p><h4 id=使用配置文件初始化了解>使用配置文件初始化（了解）</h4><p>当不使用配置类时，可以使用配置文件进行初始化。首先需要心配置 shiro 的配置文件 <code>shiro.ini</code> 。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=k>[user]</span>
</span></span><span class=line><span class=cl><span class=c1>#username=password</span>
</span></span><span class=line><span class=cl><span class=na>zhangsan</span><span class=o>=</span><span class=s>123456</span>
</span></span></code></pre></td></tr></table></div></div><p>使用 <code>IniSecurityManagerFactory</code> 和配置文件初始化工厂，并使用工厂对象获得 SecurityManager 的对象，并将 securityManager 设置为当前权限管理对象。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Factory</span><span class=o>&lt;</span><span class=n>SecurityManager</span><span class=o>&gt;</span> <span class=n>factory</span> <span class=o>=</span> <span class=k>new</span> <span class=n>IniSecurityManagerFactory</span><span class=o>(</span><span class=s>&#34;classpath:shiro.ini&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>SecurityManager</span> <span class=n>securityManager</span> <span class=o>=</span> <span class=n>factory</span><span class=o>.</span><span class=na>getInstance</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=n>SecurityUtils</span><span class=o>.</span><span class=na>setSecurityManager</span><span class=o>(</span><span class=n>securityManager</span><span class=o>);</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=使用配置类时>使用配置类时</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Bean</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=n>DefaultWebSecurityManager</span> <span class=nf>defaultWebSecurityManager</span><span class=o>(</span><span class=nd>@Qualifier</span><span class=o>(</span><span class=s>&#34;userRealm&#34;</span><span class=o>)</span> <span class=n>USerRealm</span> <span class=n>userRealm</span><span class=o>,</span> <span class=n>DefaultWebSessionManager</span> <span class=n>defaultWebSessionManager</span><span class=o>){</span>
</span></span><span class=line><span class=cl>    <span class=n>DefaultWebSecurityManager</span> <span class=n>defaultWebSecurityManager</span> <span class=o>=</span> <span class=k>new</span> <span class=n>DefaultWebSecurityManager</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>defaultWebSecurityManager</span><span class=o>.</span><span class=na>setRealm</span><span class=o>(</span><span class=n>userRealm</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>defaultWebSecurityManager</span><span class=o>.</span><span class=na>setSessionManager</span><span class=o>(</span><span class=n>defaultWebSessionManager</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>defaultWebSecurityManager</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=获取-subject-对象>获取 Subject 对象</h3><p>通过 SecurityUtils 即可以获取到 subject 对象，该对象调用 <code>login</code> 方法时，会执行 <code>Realm</code> 的认证和授权步骤。如果没有指定 <code>Realm</code> 时，则会执行默认的 <code>IniRealm</code> 下的方法，该默认的 <code>IniRealm</code> 方法会在 <code>ini</code> 文件查询用户信息。如果验证失败，则抛出异常。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>Subject</span> <span class=n>subject</span> <span class=o>=</span> <span class=n>SecurityUtils</span><span class=o>.</span><span class=na>getSubject</span><span class=o>();</span>
</span></span><span class=line><span class=cl><span class=n>UsernamePasswordToken</span> <span class=n>token</span> <span class=o>=</span> <span class=k>new</span> <span class=n>UsernamePasswordToken</span><span class=o>(</span><span class=n>username</span><span class=o>,</span> <span class=n>password</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=k>try</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>subject</span><span class=o>.</span><span class=na>login</span><span class=o>(</span><span class=n>token</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s>&#34;index&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span><span class=k>catch</span> <span class=o>(</span><span class=n>UnknownAccountException</span> <span class=n>e</span><span class=o>){</span>
</span></span><span class=line><span class=cl>    <span class=n>model</span><span class=o>.</span><span class=na>addAttribute</span><span class=o>(</span><span class=s>&#34;msg&#34;</span><span class=o>,</span> <span class=s>&#34;用户名错误&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s>&#34;login&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span><span class=k>catch</span> <span class=o>(</span><span class=n>IncorrectCredentialsException</span> <span class=n>e</span><span class=o>){</span>
</span></span><span class=line><span class=cl>    <span class=n>model</span><span class=o>.</span><span class=na>addAttribute</span><span class=o>(</span><span class=s>&#34;msg&#34;</span><span class=o>,</span> <span class=s>&#34;密码错误&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s>&#34;login&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=自定义-realm>自定义 Realm</h3><p>默认的 Realm 无法满足用户需求，一般需要继承 <code>AuthorizingRealm</code> 对象，并重写认证和授权的方法。当返回结果为 null 时，则抛出异常。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>class</span> <span class=nc>USerRealm</span> <span class=kd>extends</span> <span class=n>AuthorizingRealm</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=nd>@Autowired</span>
</span></span><span class=line><span class=cl>    <span class=n>UserService</span> <span class=n>userService</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>protected</span> <span class=n>AuthorizationInfo</span> <span class=nf>doGetAuthorizationInfo</span><span class=o>(</span><span class=n>PrincipalCollection</span> <span class=n>principalCollection</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;执行授权&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>SimpleAuthorizationInfo</span> <span class=n>info</span> <span class=o>=</span> <span class=k>new</span> <span class=n>SimpleAuthorizationInfo</span><span class=o>();</span>
</span></span><span class=line><span class=cl>        <span class=n>info</span><span class=o>.</span><span class=na>addStringPermission</span><span class=o>(</span><span class=s>&#34;user:add&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>Set</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span> <span class=n>set</span> <span class=o>=</span> <span class=k>new</span> <span class=n>HashSet</span><span class=o>&lt;&gt;();</span>
</span></span><span class=line><span class=cl>        <span class=n>set</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=s>&#34;user.add&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>info</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nd>@Override</span>
</span></span><span class=line><span class=cl>    <span class=kd>protected</span> <span class=n>AuthenticationInfo</span> <span class=nf>doGetAuthenticationInfo</span><span class=o>(</span><span class=n>AuthenticationToken</span> <span class=n>authenticationToken</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>AuthenticationException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;执行认证&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>UsernamePasswordToken</span> <span class=n>usertoken</span> <span class=o>=</span> <span class=o>(</span><span class=n>UsernamePasswordToken</span><span class=o>)</span> <span class=n>authenticationToken</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=n>User</span> <span class=n>user</span> <span class=o>=</span> <span class=n>userService</span><span class=o>.</span><span class=na>queryUserByName</span><span class=o>(</span><span class=n>usertoken</span><span class=o>.</span><span class=na>getUsername</span><span class=o>());</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span><span class=o>(</span><span class=n>user</span> <span class=o>==</span> <span class=kc>null</span><span class=o>){</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=kc>null</span><span class=o>;</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=k>new</span> <span class=n>SimpleAuthenticationInfo</span><span class=o>(</span><span class=s>&#34;&#34;</span><span class=o>,</span> <span class=n>user</span><span class=o>.</span><span class=na>getPassword</span><span class=o>(),</span> <span class=s>&#34;&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=使用配置文件了解>使用配置文件（了解）</h4><p>需要在 shiro-ini 配置文件中设置 Realm</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-ini data-lang=ini><span class=line><span class=cl><span class=k>[main]</span>
</span></span><span class=line><span class=cl><span class=c1># 需要全类名</span>
</span></span><span class=line><span class=cl><span class=na>customReal</span><span class=o>=</span><span class=s>com.cskaoyan.shiro.CustomShiro </span>
</span></span><span class=line><span class=cl><span class=na>securityManager.realm</span><span class=o>=</span><span class=s>$userRealm</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=使用配置类>使用配置类</h4><p>需要在 SecurityManager 对象内设置自定义的 Realm。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>defaultWebSecurityManager</span><span class=o>.</span><span class=na>setRealm</span><span class=o>(</span><span class=n>userRealm</span><span class=o>);</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=配置filter>配置Filter</h3><p>服务器内的资源并不是对所有用户都是可以访问的，需要对资源进行权限管理（也可以对用户进行权限管理，但用户管理起来更加不方便，同时是对用户进行角色划分，同时对资源根据不同的角色进行权限管理），这时需要使用过滤器对不同的 url 进行权限设置。</p><h4 id=使用配置文件>使用配置文件</h4><p>首先在 web.xml 文件中配置 shiro 的过滤器。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;filter&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;filter-name&gt;</span>shiro<span class=nt>&lt;/filter-name&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;filter-class&gt;</span>org.springframework.web.filter.DelegatingFilterProxy<span class=nt>&lt;/filter-class&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;init-param&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;param-name&gt;</span>targetFilterLifecycle<span class=nt>&lt;/param-name&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;param-value&gt;</span>true<span class=nt>&lt;/param-value&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/init-param&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;init-param&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;param-name&gt;</span>targetBeanName<span class=nt>&lt;/param-name&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;param-value&gt;</span>shiroFilter<span class=nt>&lt;/param-value&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/init-param&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/filter&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;filter-mapping&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;filter-name&gt;</span>shiro<span class=nt>&lt;/filter-name&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;url-pattern&gt;</span>/*<span class=nt>&lt;/url-pattern&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/filter-mapping&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>接着 spring 的配置文件 application.xml 配置过滤选项，验证 url 路径由上至下依次匹配。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;shiroFilter&#34;</span> <span class=na>class=</span><span class=s>&#34;org.apache.shiro.spring.web.ShiroFilterFactoryBean&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;securityManager&#34;</span> <span class=na>ref=</span><span class=s>&#34;securityManager&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;loginUrl&#34;</span> <span class=na>value=</span><span class=s>&#34;/login&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;unauthorizedUrl&#34;</span> <span class=na>value=</span><span class=s>&#34;/unAuthor&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;filterChainDefinitions&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;value&gt;</span>
</span></span><span class=line><span class=cl>            /refuse = anon
</span></span><span class=line><span class=cl>            /index.jsp = anon
</span></span><span class=line><span class=cl>            /login.jsp = anon
</span></span><span class=line><span class=cl>            /login = anon
</span></span><span class=line><span class=cl>            /logout = logout
</span></span><span class=line><span class=cl>            /** = authc
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/value&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/property&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/bean&gt;</span>
</span></span></code></pre></td></tr></table></div></div><table><thead><tr><th>标签名称</th><th>标签条件（均是显示标签内容）</th></tr></thead><tbody><tr><td><a href=shiro:authenticated rel>shiro:authenticated</a></td><td>登录之后</td></tr><tr><td><a href=shiro:notAuthenticated rel>shiro:notAuthenticated</a></td><td>不在登录状态时</td></tr><tr><td><a href=shiro:guest rel>shiro:guest</a></td><td>用户在没有RememberMe时</td></tr><tr><td><a href=shiro:user rel>shiro:user</a></td><td>用户在RememberMe时</td></tr><tr><td>&lt;shiro:hasAnyRoles name=&ldquo;abc,123&rdquo; ></td><td>在有abc或者123角色时</td></tr><tr><td>&lt;shiro:hasRole name=&ldquo;abc&rdquo;></td><td>拥有角色abc</td></tr><tr><td>&lt;shiro:lacksRole name=&ldquo;abc&rdquo;></td><td>没有角色abc</td></tr><tr><td>&lt;shiro:hasPermission name=&ldquo;abc&rdquo;></td><td>拥有权限资源abc</td></tr><tr><td>&lt;shiro:lacksPermission name=&ldquo;abc&rdquo;></td><td>没有abc权限资源</td></tr><tr><td><a href=shiro:principal rel>shiro:principal</a></td><td>显示用户身份名称</td></tr></tbody></table><p>&lt;shiro:principal property=&ldquo;username&rdquo;/> 显示用户身份中的属性值</p><p>当认证出现错误时，返回给用户的不应该是一个异常，而是需要对其进行重定向进行重新认证，上述配置中的 <code>unauthorizedUrl</code> 异常对应为认证异常重定向的 url ，<code>loginUrl</code> 对应的为登陆的 url ，logout 为注销的的url ，该 url 可以不配置映射即可以使用。</p><h4 id=使用配置类-1>使用配置类</h4><p>通过 <code>ShiroFilterFactoryBean</code> 工厂对象设置 url 权限。该权限为一个 map，key 对应的是 url 路径，而 value 对应的为所需要的权限。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>filterMap</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=s>&#34;/user/add&#34;</span><span class=o>,</span> <span class=s>&#34;perms[user:add]&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>filterMap</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=s>&#34;/user/*&#34;</span><span class=o>,</span> <span class=s>&#34;authc&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>shiroFilterFactoryBean</span><span class=o>.</span><span class=na>setFilterChainDefinitionMap</span><span class=o>(</span><span class=n>filterMap</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>shiroFilterFactoryBean</span><span class=o>.</span><span class=na>setLoginUrl</span><span class=o>(</span><span class=s>&#34;/tologin&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl><span class=n>shiroFilterFactoryBean</span><span class=o>.</span><span class=na>setUnauthorizedUrl</span><span class=o>(</span><span class=s>&#34;/noauth&#34;</span><span class=o>);</span>
</span></span></code></pre></td></tr></table></div></div><p>当存在大量的 url 时，使用 map 管理起来可能不方便，则可以使用注解的方式，则需要在相应的 controller 配置权限控制。</p><p>使用注解是，需要导入 aop 技术，即需要导入 <code>aspectjweaver</code> 依赖，同时在 application-mvc.xml 中注册 advisor 对象。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;groupId&gt;</span>org.aspectj<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;artifactId&gt;</span>aspectjweaver<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;version&gt;</span>1.6.12<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/dependency&gt;</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>class=</span><span class=s>&#34;org.apache.shiro.spring.security.interceptor.AuthorizationAttributeSourceAdvisor&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;securityManager&#34;</span> <span class=na>ref=</span><span class=s>&#34;securityManager&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/bean&gt;</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@RequestMapping</span><span class=o>(</span><span class=s>&#34;/user/query&#34;</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=nd>@RequiresPermissions</span><span class=o>(</span><span class=n>value</span> <span class=o>=</span> <span class=o>{</span><span class=s>&#34;user:query&#34;</span><span class=o>,</span> <span class=s>&#34;user:delete&#34;</span><span class=o>},</span> <span class=n>logical</span> <span class=o>=</span> <span class=n>Logical</span><span class=o>.</span><span class=na>OR</span><span class=o>)</span>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=n>String</span> <span class=nf>queryUser</span><span class=o>(</span><span class=n>String</span> <span class=n>name</span><span class=o>,</span> <span class=n>Model</span> <span class=n>model</span><span class=o>){</span>
</span></span><span class=line><span class=cl>    <span class=n>User</span> <span class=n>user</span> <span class=o>=</span> <span class=n>userService</span><span class=o>.</span><span class=na>queryUserByName</span><span class=o>(</span><span class=n>name</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>model</span><span class=o>.</span><span class=na>addAttribute</span><span class=o>(</span><span class=s>&#34;user&#34;</span><span class=o>,</span> <span class=n>user</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s>&#34;/WEB-INF/view/user.jsp&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Shiro共有5个注解， 详细如下</p><ul><li><strong>RequiresAuthentication:</strong></li></ul><p>使用该注解标注的类，实例，方法在访问或调用时，当前Subject必须在当前session中已经过认证。</p><ul><li><strong>RequiresGuest:</strong></li></ul><p>使用该注解标注的类，实例，方法在访问或调用时，当前Subject可以是“gust”身份，不需要经过认证或者在原先的session中存在记录。</p><ul><li><strong>RequiresPermissions:</strong></li></ul><p>当前Subject需要拥有某些特定的权限时，才能执行被该注解标注的方法。如果当前Subject不具有这样的权限，则方法不会被执行。</p><ul><li><strong>RequiresRoles:</strong></li></ul><p>当前Subject必须拥有所有指定的角色时，才能访问被该注解标注的方法。如果当天Subject不同时拥有所有指定角色，则方法不会执行还会抛出AuthorizationException异常。</p><ul><li><strong>RequiresUser</strong></li></ul><p>当前Subject必须是应用的用户，才能访问或调用被该注解标注的类，实例，方法。</p><p><strong>注意：Shiro的认证注解处理是有内定的处理顺序的，如果有个多个注解的话，前面的通过了会继续检查后面的，若不通过则直接返回，处理顺序依次为（与实际声明顺序无关）</strong></p><h2 id=其他>其他</h2><p>使用 shiro 对查询用户的权限时，都是通过访问数据库进行查询，为了减少磁盘的 IO，可以使用缓存来减少磁盘的 IO，shiro 默认是关闭认证信息缓存的，对于授权信息的缓存shiro默认开启的，但需要导入依赖和配置其 cacheManager。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;groupId&gt;</span>org.apache.shiro<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;artifactId&gt;</span>shiro-ehcache<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;version&gt;</span>1.2.3<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/dependency&gt;</span>
</span></span><span class=line><span class=cl><span class=c>&lt;!-- 缓存ehcache --&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;dependency&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;groupId&gt;</span>net.sf.ehcache<span class=nt>&lt;/groupId&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;artifactId&gt;</span>ehcache<span class=nt>&lt;/artifactId&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;version&gt;</span>2.8.1<span class=nt>&lt;/version&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/dependency&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>同时注册 EhCacheManager，并在 SecurityManager 中设置相应的 cacheManager。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;cacheManager&#34;</span> <span class=na>class=</span><span class=s>&#34;org.apache.shiro.cache.ehcache.EhCacheManager&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;cacheManagerConfigFile&#34;</span> <span class=na>value=</span><span class=s>&#34;classpath:shiro-ehcache.xml&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/bean&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;securtyManager&#34;</span> <span class=na>class=</span><span class=s>&#34;org.apache.shiro.web.mgt.Default.WebSecurityManager&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>	<span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;cacheManager&#34;</span> <span class=na>ref=</span><span class=s>&#34;cacheManager&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/bean&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>当用户权限时，缓存的信息不会更改，如果权限发生变化时，则需要更新缓存。可以在更新权限的同时，同时调用更新缓存的方法。</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2022-04-20</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/posts/shiro-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html/index.md target=_blank>阅读原始文档</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 Twitter" data-sharer=twitter data-url=https://luckyouo.github.io/posts/shiro-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html/ data-title="Shiro 学习笔记" data-via=xxxx data-hashtags=shiro><i class="fab fa-twitter fa-fw"></i></a><a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://luckyouo.github.io/posts/shiro-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html/ data-hashtag=shiro><i class="fab fa-facebook-square fa-fw"></i></a><a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://luckyouo.github.io/posts/shiro-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html/ data-title="Shiro 学习笔记"><i class="fab fa-weibo fa-fw"></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/shiro/>shiro</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/python-%E7%B1%BB%E6%A8%A1%E5%9D%97%E5%92%8C%E5%8C%85.html/ class=prev rel=prev title="Python 类、模块和包"><i class="fas fa-angle-left fa-fw"></i>Python 类、模块和包</a>
<a href=/posts/dataset-sampler-%E5%92%8C-dataloader-%E4%B8%89%E8%80%85%E7%9A%84%E5%85%B3%E7%B3%BB.html/ class=next rel=next title="Dataset 、 Sampler 和 Dataloader 三者的关系">Dataset 、 Sampler 和 Dataloader 三者的关系<i class="fas fa-angle-right fa-fw"></i></a></div></div><div id=comments></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><span id=run-time></span></div><div class=footer-line>由 <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.106.0">Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2022</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>luckyouo</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw"></i></a></div><div class=sidebar_wo><div id=leimu><img src=https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/b2t/leimuA.png alt=雷姆 onmouseover='this.src="https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/b2t/leimuB.png"' onmouseout='this.src="https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/b2t/leimuA.png"' title=回到顶部></div><div class=sidebar_wo id=lamu><img src=https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/b2t/lamuA.png alt=雷姆 onmouseover='this.src="https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/b2t/lamuB.png"' onmouseout='this.src="https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/b2t/lamuA.png"' title=回到底部></div></div><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=stylesheet href=/lib/katex/copy-tex.min.css><link rel=stylesheet href=/lib/cookieconsent/cookieconsent.min.css><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lunr/lunr.stemmer.support.min.js></script><script type=text/javascript src=/lib/lunr/lunr.zh.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js></script><script type=text/javascript src=/lib/katex/auto-render.min.js></script><script type=text/javascript src=/lib/katex/copy-tex.min.js></script><script type=text/javascript src=/lib/katex/mhchem.min.js></script><script type=text/javascript src=/lib/cookieconsent/cookieconsent.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:15},comment:{},cookieconsent:{content:{dismiss:"同意",link:"了解更多",message:"本网站使用 Cookies 来改善您的浏览体验."},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",lunrLanguageCode:"zh",lunrSegmentitURL:"/lib/lunr/lunr.segmentit.js",maxResultLength:10,noResultsFound:"没有找到结果",snippetLength:50,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/jquery@2.1.3/dist/jquery.min.js></script><script type=text/javascript src=/js/custom.js></script></body></html>