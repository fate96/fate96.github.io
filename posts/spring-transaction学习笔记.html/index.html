<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><meta http-equiv=x-ua-compatible content="IE=edge, chrome=1"><title>Spring Transaction学习笔记 - Luckyouo Blog</title><meta name=Description content="Luckyouo 的小窝"><meta property="og:title" content="Spring Transaction学习笔记"><meta property="og:description" content="前言 在 Spring 框架中，需要使用事务管理对数据库进行操作，以实现事务的 ACID 特性。 事务的基本实现 Spring 框架提供了三个对象来管理事务。 PlatformTransactionManager ：平台事务管理器，sp"><meta property="og:type" content="article"><meta property="og:url" content="https://luckyouo.github.io/posts/spring-transaction%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html/"><meta property="og:image" content="https://luckyouo.github.io/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-04-05T19:53:07+08:00"><meta property="article:modified_time" content="2022-04-20T16:59:56+08:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://luckyouo.github.io/logo.png"><meta name=twitter:title content="Spring Transaction学习笔记"><meta name=twitter:description content="前言 在 Spring 框架中，需要使用事务管理对数据库进行操作，以实现事务的 ACID 特性。 事务的基本实现 Spring 框架提供了三个对象来管理事务。 PlatformTransactionManager ：平台事务管理器，sp"><meta name=application-name content="LoveIt"><meta name=apple-mobile-web-app-title content="LoveIt"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://luckyouo.github.io/posts/spring-transaction%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html/><link rel=prev href=https://luckyouo.github.io/posts/spring-jdbc-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html/><link rel=next href=https://luckyouo.github.io/posts/spring-mvc-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Spring Transaction学习笔记","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/luckyouo.github.io\/posts\/spring-transaction%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html\/"},"genre":"posts","keywords":"Transaction","wordcount":767,"url":"https:\/\/luckyouo.github.io\/posts\/spring-transaction%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html\/","datePublished":"2022-04-05T19:53:07+08:00","dateModified":"2022-04-20T16:59:56+08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"luckyouo"},"description":""}</script></head><body header-desktop=fixed header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><a href=https://github.com/luckyouo class=github-corner target=_blank title="Follow me on GitHub" aria-label="Follow me on GitHub"><svg width="3.5rem" height="3.5rem" viewBox="0 0 250 250" style="fill:#70b7fd;color:#fff;position:absolute;top:0;border:0;left:0;transform:scale(-1,1)" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><div class=header-title><a href=/ title="Luckyouo Blog">Luckyouo Blogs</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>归档 </a><a class=menu-item href=/tags/>标签 </a><a class=menu-item href=/categories/>分类 </a><a class=menu-item href=/friends/><i class='fas fa-fw fa-fan fa-spin'></i> 友链 </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder=搜索文章标题或内容... id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin"></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题><i class="fas fa-adjust fa-fw"></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Luckyouo Blog">Luckyouo Blogs</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容... id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fas fa-search fa-fw"></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fas fa-times-circle fa-fw"></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin"></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></div><a class=menu-item href=/posts/ title>归档</a><a class=menu-item href=/tags/ title>标签</a><a class=menu-item href=/categories/ title>分类</a><a class=menu-item href=/friends/ title><i class='fas fa-fw fa-fan fa-spin'></i>友链</a><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw"></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class="toc-content always-active" id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animated flipInX">Spring Transaction学习笔记</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw"></i>luckyouo</a></span>&nbsp;<span class=post-category>收录于 <a href=/categories/spring/><i class="far fa-folder fa-fw"></i>Spring</a></span></div><div class=post-meta-line><i class="far fa-calendar fa-fw"></i>&nbsp;<time datetime=2022-04-05>2022-04-05</time>&nbsp;<i class="far fa-calendar-plus fa-fw"></i>&nbsp;<time datetime=2022-04-20>2022-04-20</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 767 字&nbsp;
<i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 2 分钟&nbsp;</div></div><div class="details toc" id=toc-static kept><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right"></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ol><li><a href=#前言>前言</a></li><li><a href=#事务的基本实现>事务的基本实现</a><ol><li><a href=#使用流程>使用流程</a></li></ol></li></ol></nav></div></div><div class=content id=content><h2 id=前言>前言</h2><p>在 Spring 框架中，需要使用事务管理对数据库进行操作，以实现事务的 <code>ACID</code> 特性。</p><h2 id=事务的基本实现>事务的基本实现</h2><p>Spring 框架提供了三个对象来管理事务。</p><ol><li><p><code>PlatformTransactionManager</code> ：平台事务管理器，spring要管理事务，必须使用事务管理器。事务配置的过程中，也必须配置事务管理器，常见的事务管理器有：</p><ul><li><code>DataSourceTransactionManager</code> ，在jdbc开发中采用 <code>JdbcTemplate</code> 。(常用)</li><li><code>HibernateTransactionManage</code> ，hibernate开发时事务管理器，整合hibernate。</li></ul><p>常用 <code>api</code> 有三个：</p><ul><li><code>TransactionStatus getTransaction(TransactionDefinition definition)</code> ： 事务管理器 通过“事务详情”，获得“事务状态”，从而管理事务。 获取事务状态后，Spring根据传播行为来决定如何开启事务</li><li><code>void commit(TransactionStatus status)</code> ： 根据状态提交</li><li><code>void rollback(TransactionStatus status)</code> ： 根据状态回滚</li></ul></li><li><p><code>TransactionDefinition</code> ：这个接口的作用就是定义事务的名称、隔离级别、传播行为、超时时间长短、只读属性等。</p></li><li><p><code>TransactionStatus</code> ： 这个接口的作用就是获取事务的状态（回滚点、是否完成、是否新事物、是否回滚）属性</p></li></ol><h3 id=使用流程>使用流程</h3><p>首先需要导入 <code>spring-tx</code> 包。</p><p>实现方式有四种：</p><ol><li><p>使用事务模板完成</p><ul><li>向容器中注册 <code>TransactionTemplate</code> 对象，然后在<code>Service</code> 类中引入事务管理器</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;myUserServiceImpl&#34;</span> <span class=na>class=</span><span class=s>&#34;com.cskaoyan.service.UserServiceImpl&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;dao&#34;</span> <span class=na>ref=</span><span class=s>&#34;accountdaoImpl&#34;</span><span class=nt>&gt;&lt;/property&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;transactionTemplate&#34;</span> <span class=na>ref=</span><span class=s>&#34;myTransactionTemplate&#34;</span><span class=nt>&gt;&lt;/property&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/bean&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;myTransactionTemplate&#34;</span> <span class=na>class=</span><span class=s>&#34;org.springframework.transaction.support.TransactionTemplate&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;transactionmanager&#34;</span> <span class=na>ref=</span><span class=s>&#34;myTransactionmanager&#34;</span><span class=nt>&gt;&lt;/property&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/bean&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;myTransactionmanager&#34;</span> <span class=na>class=</span><span class=s>&#34;org.springframework.transaction.support.TransactionManager&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;datasource&#34;</span> <span class=na>ref=</span><span class=s>&#34;mydatasource&#34;</span><span class=nt>&gt;&lt;/property&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/bean&gt;</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Autowired</span>
</span></span><span class=line><span class=cl><span class=n>TransactionTemplate</span> <span class=n>transactionTemplate</span><span class=o>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>public</span> <span class=kt>void</span> <span class=nf>setTransactionTemplate</span><span class=o>(</span><span class=n>TransactionTemplate</span> <span class=n>transactionTemplate</span><span class=o>){</span>
</span></span><span class=line><span class=cl>    <span class=k>this</span><span class=o>.</span><span class=na>transactionTemplate</span> <span class=o>=</span> <span class=n>transactionTemplate</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><ul><li>在需要执行的事务业务中，使用 <code>transactionTemplate</code> 对象执行 <code>execute(new TransactionCallbackWithoutResult(){})</code>方法。在匿名类中写事务代码。</li></ul><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>transactionTemplate</span><span class=o>.</span><span class=na>execute</span><span class=o>(</span><span class=k>new</span> <span class=n>TransactionCallbackWithoutResult</span><span class=o>(){</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 执行所需要的事务
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>})</span>
</span></span></code></pre></td></tr></table></div></div></li><li><p>使用配置文件配置事务</p></li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;myServiceProxyFactoryBean&#34;</span> <span class=na>class=</span><span class=s>&#34;org.springframework.transaction.interceptor.TransactionProxyFactoryBean&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;proxyInterface&#34;</span> <span class=na>value=</span><span class=s>&#34;com.cskaoyan.service.UserService&#34;</span><span class=nt>&gt;&lt;/property&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;target&#34;</span> <span class=na>ref=</span><span class=s>&#34;myServiceImpl&#34;</span><span class=nt>&gt;&lt;/property&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;transactionManager&#34;</span> <span class=na>ref=</span><span class=s>&#34;myTransactionManager&#34;</span><span class=nt>&gt;&lt;/property&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;preoerty</span> <span class=na>name=</span><span class=s>&#34;transactionAttribues&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;props&gt;</span>
</span></span><span class=line><span class=cl>            <span class=nt>&lt;prop</span> <span class=na>ket=</span><span class=s>&#34;transferMoney&#34;</span><span class=nt>&gt;</span>PROPAGATION_REQUIRED,ISOLATION_REPEATABLE_READ<span class=nt>&lt;/prop&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;/props&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/preoerty&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/bean&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;bean</span> <span class=na>id=</span><span class=s>&#34;myTransactionManager&#34;</span> <span class=na>class=</span><span class=s>&#34;org.springframework.transaction.support.TransactionManager&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;property</span> <span class=na>name=</span><span class=s>&#34;datasource&#34;</span> <span class=na>ref=</span><span class=s>&#34;mydatasource&#34;</span><span class=nt>&gt;&lt;/property&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/bean&gt;</span>
</span></span></code></pre></td></tr></table></div></div><ol start=3><li>使用事务模板实现，通过使用 <code>spring-tx</code> 配置，首先使用 <code>spring-tx</code> 的schema</li></ol><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;beans</span> <span class=na>xmlns=</span><span class=s>&#34;http://www.springframework.org/schema/beans&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>xmlns:xsi=</span><span class=s>&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>xmlns:aop=</span><span class=s>&#34;http://www.springframework.org/schema/aop&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>xmlns:tx=</span><span class=s>&#34;http://www.springframework.org/schema/tx&#34;</span> 
</span></span><span class=line><span class=cl>    <span class=na>xsi:schemaLocation=</span><span class=s>&#34;
</span></span></span><span class=line><span class=cl><span class=s>        http://www.springframework.org/schema/beans https://www.springframework.org/schema/beans/spring-beans.xsd
</span></span></span><span class=line><span class=cl><span class=s>        http://www.springframework.org/schema/tx https://www.springframework.org/schema/tx/spring-tx.xsd 
</span></span></span><span class=line><span class=cl><span class=s>        http://www.springframework.org/schema/aop https://www.springframework.org/schema/aop/spring-aop.xsd&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!-- bean definitions here --&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;/beans&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>接着配置事务，与 <code>aop:advisor</code> 配合一起使用。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;aop:config&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;aop:point-cut</span> <span class=na>id=</span><span class=s>&#34;mypointcut&#34;</span> <span class=na>expression=</span><span class=s>&#34;execution(* com..impl...*(..))&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;aop:advisor</span> <span class=na>advice-ref=</span><span class=s>&#34;txAdvice&#34;</span> <span class=na>pointcut-ref=</span><span class=s>&#34;mypointcut&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/aop:config&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nt>&lt;tx:advice</span> <span class=na>id=</span><span class=s>&#34;txAdvice&#34;</span> <span class=na>transaction-manager=</span><span class=s>&#34;myTransactionManager&#34;</span><span class=nt>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;tx:attribues&gt;</span>
</span></span><span class=line><span class=cl>        <span class=nt>&lt;tx:method</span> <span class=na>name=</span><span class=s>&#34;transferMoney&#34;</span> <span class=na>propagation=</span><span class=s>&#34;REQUIRED&#34;</span> <span class=na>isolation=</span><span class=s>&#34;DEFAULT&#34;</span><span class=nt>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=nt>&lt;/tx:attribues&gt;</span>
</span></span><span class=line><span class=cl><span class=nt>&lt;/tx:advice&gt;</span>
</span></span></code></pre></td></tr></table></div></div><ol start=4><li>通过spring tx 注解实现，在需要执行事务而方法中使用注解。（常用方式）</li></ol><p>首先配置注解驱动</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-xml data-lang=xml><span class=line><span class=cl><span class=nt>&lt;tx:annotation-direver</span> <span class=na>transaction-manager=</span><span class=s>&#34;txManager&#34;</span><span class=nt>/&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>接着在所需要执行事务的方法中配置注解</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=nd>@Transactional</span><span class=o>(</span><span class=n>isolation</span><span class=o>=</span><span class=n>Isolation</span><span class=o>.</span><span class=na>Default</span><span class=o>,</span> <span class=n>propagation</span><span class=o>=</span><span class=n>Propagation</span><span class=o>.</span><span class=na>REQUIRED</span><span class=o>)</span>
</span></span></code></pre></td></tr></table></div></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2022-04-20</span></div><div class=post-info-license></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/posts/spring-transaction%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html/index.md target=_blank>阅读原始文档</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 Twitter" data-sharer=twitter data-url=https://luckyouo.github.io/posts/spring-transaction%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html/ data-title="Spring Transaction学习笔记" data-via=xxxx data-hashtags=Transaction><i class="fab fa-twitter fa-fw"></i></a><a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://luckyouo.github.io/posts/spring-transaction%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html/ data-hashtag=Transaction><i class="fab fa-facebook-square fa-fw"></i></a><a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://luckyouo.github.io/posts/spring-transaction%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html/ data-title="Spring Transaction学习笔记"><i class="fab fa-weibo fa-fw"></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw"></i>&nbsp;<a href=/tags/transaction/>Transaction</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/posts/spring-jdbc-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html/ class=prev rel=prev title="Spring JDBC 学习笔记"><i class="fas fa-angle-left fa-fw"></i>Spring JDBC 学习笔记</a>
<a href=/posts/spring-mvc-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0.html/ class=next rel=next title="Spring MVC 学习笔记">Spring MVC 学习笔记<i class="fas fa-angle-right fa-fw"></i></a></div></div><div id=comments></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><span id=run-time></span></div><div class=footer-line>由 <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.111.3">Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a></div><div class=footer-line><i class="far fa-copyright fa-fw"></i><span itemprop=copyrightYear>2022 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>luckyouo</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw"></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw"></i></a></div><div class=sidebar_wo><div id=leimu><img src=https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/b2t/leimuA.png alt=雷姆 onmouseover='this.src="https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/b2t/leimuB.png"' onmouseout='this.src="https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/b2t/leimuA.png"' title=回到顶部></div><div class=sidebar_wo id=lamu><img src=https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/b2t/lamuA.png alt=雷姆 onmouseover='this.src="https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/b2t/lamuB.png"' onmouseout='this.src="https://cdn.jsdelivr.net/gh/lewky/lewky.github.io@master/images/b2t/lamuA.png"' title=回到底部></div></div><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=stylesheet href=/lib/katex/copy-tex.min.css><link rel=stylesheet href=/lib/cookieconsent/cookieconsent.min.css><script type=text/javascript src=/lib/smooth-scroll/smooth-scroll.min.js></script><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lunr/lunr.stemmer.support.min.js></script><script type=text/javascript src=/lib/lunr/lunr.zh.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js></script><script type=text/javascript src=/lib/katex/auto-render.min.js></script><script type=text/javascript src=/lib/katex/copy-tex.min.js></script><script type=text/javascript src=/lib/katex/mhchem.min.js></script><script type=text/javascript src=/lib/cookieconsent/cookieconsent.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:15},comment:{},cookieconsent:{content:{dismiss:"同意",link:"了解更多",message:"本网站使用 Cookies 来改善您的浏览体验."},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",lunrLanguageCode:"zh",lunrSegmentitURL:"/lib/lunr/lunr.segmentit.js",maxResultLength:10,noResultsFound:"没有找到结果",snippetLength:50,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/jquery@2.1.3/dist/jquery.min.js></script><script type=text/javascript src=/js/custom.js></script></body></html>